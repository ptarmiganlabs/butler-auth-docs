<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.80.0" /><link rel="canonical" type="text/html" href="https://butler-auth.ptarmiganlabs.com/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="https://butler-auth.ptarmiganlabs.com/docs/index.xml">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Documentation | Butler Auth</title><meta property="og:title" content="Documentation" />
<meta property="og:description" content="Butler Auth documentation" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://butler-auth.ptarmiganlabs.com/docs/" />
<meta property="og:site_name" content="Butler Auth" />
<meta itemprop="name" content="Documentation">
<meta itemprop="description" content="Butler Auth documentation">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Documentation"/>
<meta name="twitter:description" content="Butler Auth documentation"/>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-58487795-6', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






<link rel="preload" href="/scss/main.min.6faa0504dc2f4eea8bfbd89b1466dddc242fe9703099833f3f66f8ba48501b5f.css" as="style">
<link href="/scss/main.min.6faa0504dc2f4eea8bfbd89b1466dddc242fe9703099833f3f66f8ba48501b5f.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg width="150" height="106" viewBox="0 0 150 106" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="group"><path id="Path" d="M11.575.0H138.012C141.082.0 144.026 1.218 146.197 3.386 148.368 5.553 149.587 8.494 149.587 11.559V94.252C149.587 100.636 144.405 105.812 138.012 105.812H11.575C8.505 105.812 5.561 104.594 3.39 102.426 1.219 100.258.0 97.318.0 94.252V11.559C0 5.175 5.182.0 11.575.0" fill="#a00" fill-opacity="1" stroke="none"/><g id="group-1"><path id="Path-1" d="M83.952 18.654C83.952 23.276 80.468 27.022 76.171 27.022 71.874 27.022 68.39 23.276 68.39 18.654 68.39 14.033 71.874 10.287 76.171 10.287 80.468 10.287 83.952 14.033 83.952 18.654z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-2" d="M72.069 55.579C73.887 55.579 75.361 57.051 75.361 58.866V92.935C75.361 94.75 73.887 96.222 72.069 96.222S68.777 94.75 68.777 92.935V58.866C68.777 57.051 70.251 55.579 72.069 55.579" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-3" d="M80.649 55.579C82.467 55.579 83.941 57.051 83.941 58.866V92.935C83.941 94.75 82.467 96.222 80.649 96.222S77.357 94.75 77.357 92.935V58.866C77.357 57.051 78.831 55.579 80.649 55.579" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-4" d="M83.19 28.079V50.706H70.071V28.203C65.843 28.424 62.661 28.848 62.728 29.51 62.932 31.524 64.307 32.004 64.275 34.712 66.767 40.839 65.904 57.402 64.079 59.316H63.986L64.038 59.368 63.986 59.419H64.079L75.393 70.975 76.383 69.966 77.373 70.975 88.677 59.419H88.77L88.728 59.368 88.77 59.316H88.677C86.421 54.839 86.821 40.911 87.79 35.155 88.11 31.798 89.603 30.263 90.853 28.985 91.298 28.531 87.82 28.212 83.19 28.079z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-5" d="M89.379 28.414C89.3 28.418 89.218 28.424 89.139 28.435 87.86 28.606 86.97 29.771 87.141 31.047 87.423 35.435 88.91 40.342 88.774 44.62L88.496 55.539C88.468 56.612 89.311 57.492 90.386 57.509L91.359 57.523C92.434 57.54 93.322 56.691 93.349 55.618L93.628 44.698C93.094 40.021 92.391 35.176 91.754 30.429 91.594 29.232 90.561 28.376 89.379 28.414z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-6" d="M55.216 44.247C55.73 44.588 56.359 44.711 56.964 44.589 57.569 44.468 58.101 44.111 58.443 43.597L65.703 32.684C66.044 32.171 66.168 31.543 66.046 30.938 65.923 30.334 65.566 29.803 65.052 29.462 64.538 29.121 63.909 28.998 63.304 29.119 62.698 29.241 62.167 29.598 61.825 30.112L54.565 41.025C54.224 41.538 54.1 42.166 54.222 42.771 54.344 43.375 54.702 43.906 55.216 44.247" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-7" d="M57.525 44.25C56.396 44.865 54.982 44.451 54.366 43.324L48.076 31.827C47.78 31.286 47.711 30.65 47.885 30.058S48.461 28.968 49.003 28.672C49.544 28.377 50.182 28.308 50.774 28.482 51.366 28.655 51.865 29.057 52.161 29.598L58.451 41.096C58.747 41.637 58.816 42.273 58.642 42.865 58.468 43.456 58.066 43.954 57.525 44.25" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-8" d="M49.74 21.695C45.149 21.695 41.413 24.797 41.28 28.667H58.203C58.07 24.797 54.331 21.695 49.74 21.695z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-9" d="M49.377 20.216C48.543 20.216 47.864 21.25 47.84 22.539H50.914C50.889 21.25 50.21 20.216 49.377 20.216z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-10" d="M72.302 26.849V30.828L76.17 29.443 80.04 30.828V26.849L76.17 28.234 72.302 26.849z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-11" d="M77.017 32.429C77.017 32.896 76.638 33.274 76.171 33.274 75.704 33.274 75.325 32.896 75.325 32.429 75.325 31.962 75.704 31.584 76.171 31.584 76.638 31.584 77.017 31.962 77.017 32.429z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-12" d="M77.017 39.24C77.017 39.706 76.638 40.084 76.171 40.084 75.704 40.084 75.325 39.706 75.325 39.24 75.325 38.773 75.704 38.395 76.171 38.395 76.638 38.395 77.017 38.773 77.017 39.24z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-13" d="M77.017 46.05C77.017 46.516 76.638 46.895 76.171 46.895 75.704 46.895 75.325 46.516 75.325 46.05 75.325 45.583 75.704 45.205 76.171 45.205 76.638 45.205 77.017 45.583 77.017 46.05z" fill="#000" fill-opacity="1" stroke="none"/><path id="Path-14" d="M60.014 28.681C60.014 29.09 55.417 29.422 49.746 29.422 44.074 29.422 39.477 29.09 39.477 28.681 39.477 28.272 44.074 27.941 49.746 27.941 55.417 27.941 60.014 28.272 60.014 28.681z" fill="#000" fill-opacity="1" stroke="none"/></g><g id="group-2"><path id="Path-15" d="M83.292 17.995C83.292 22.617 79.808 26.363 75.511 26.363 71.214 26.363 67.73 22.617 67.73 17.995 67.73 13.374 71.214 9.628 75.511 9.628 79.808 9.628 83.292 13.374 83.292 17.995z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-16" d="M71.409 54.92C73.227 54.92 74.701 56.392 74.701 58.207V92.276C74.701 94.091 73.227 95.563 71.409 95.563 69.591 95.563 68.117 94.091 68.117 92.276V58.207C68.117 56.392 69.591 54.92 71.409 54.92" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-17" d="M79.989 54.92C81.807 54.92 83.281 56.392 83.281 58.207V92.276C83.281 94.091 81.807 95.563 79.989 95.563S76.697 94.091 76.697 92.276V58.207C76.697 56.392 78.171 54.92 79.989 54.92" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-18" d="M82.53 27.42V50.047H69.411V27.543C65.183 27.765 62.001 28.188 62.068 28.851 62.272 30.865 63.646 31.345 63.615 34.052 66.107 40.18 65.244 56.742 63.419 58.657H63.326L63.378 58.709 63.326 58.76H63.419L74.733 70.316 75.723 69.307 76.713 70.316 88.017 58.76H88.11L88.068 58.709 88.11 58.657H88.017C85.76 54.18 86.161 40.252 87.13 34.495 87.45 31.139 88.943 29.604 90.193 28.326 90.638 27.872 87.16 27.552 82.53 27.42z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-19" d="M88.719 27.755C88.64 27.759 88.558 27.765 88.479 27.776 87.2 27.947 86.31 29.112 86.481 30.388 86.763 34.776 88.25 39.683 88.114 43.961L87.836 54.88C87.808 55.953 88.651 56.833 89.726 56.85L90.699 56.864C91.774 56.881 92.662 56.032 92.689 54.958L92.968 44.039C92.434 39.362 91.731 34.517 91.094 29.77 90.934 28.573 89.901 27.716 88.719 27.755z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-20" d="M54.556 43.588C55.07 43.929 55.699 44.052 56.304 43.93 56.909 43.809 57.441 43.452 57.783 42.938L65.043 32.025C65.384 31.512 65.508 30.884 65.385 30.279 65.263 29.675 64.906 29.144 64.392 28.803 63.878 28.462 63.249 28.338 62.644 28.46 62.038 28.582 61.506 28.939 61.165 29.453L53.905 40.366C53.564 40.879 53.44 41.507 53.562 42.111 53.684 42.716 54.042 43.247 54.556 43.588" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-21" d="M56.865 43.591C55.736 44.206 54.322 43.792 53.706 42.665L47.416 31.168C47.12 30.627 47.051 29.99 47.225 29.399 47.399 28.807 47.801 28.309 48.343 28.013 48.884 27.718 49.522 27.649 50.114 27.823 50.706 27.996 51.205 28.398 51.501 28.939L57.791 40.436C58.087 40.978 58.156 41.614 57.982 42.205 57.808 42.797 57.406 43.295 56.865 43.591" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-22" d="M49.08 21.036C44.489 21.036 40.753 24.138 40.62 28.008H57.543C57.41 24.138 53.671 21.036 49.08 21.036z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-23" d="M48.717 19.557C47.883 19.557 47.204 20.59 47.18 21.88H50.254C50.229 20.59 49.55 19.557 48.717 19.557z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-24" d="M71.641 26.189V30.168L75.51 28.784 79.38 30.168V26.189L75.51 27.575 71.641 26.189z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-25" d="M76.357 31.77C76.357 32.237 75.978 32.615 75.511 32.615S74.665 32.237 74.665 31.77C74.665 31.303 75.044 30.925 75.511 30.925S76.357 31.303 76.357 31.77z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-26" d="M76.357 38.58C76.357 39.047 75.978 39.425 75.511 39.425S74.665 39.047 74.665 38.58C74.665 38.114 75.044 37.735 75.511 37.735S76.357 38.114 76.357 38.58z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-27" d="M76.357 45.391C76.357 45.857 75.978 46.236 75.511 46.236S74.665 45.857 74.665 45.391C74.665 44.924 75.044 44.546 75.511 44.546S76.357 44.924 76.357 45.391z" fill="#fff" fill-opacity="1" stroke="none"/><path id="Path-28" d="M59.354 28.022C59.354 28.431 54.757 28.763 49.086 28.763 43.414 28.763 38.817 28.431 38.817 28.022 38.817 27.613 43.414 27.281 49.086 27.281 54.757 27.281 59.354 27.613 59.354 28.022z" fill="#fff" fill-opacity="1" stroke="none"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Butler Auth</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a  class="nav-link" href="/docs/about/butler-auth/" ><span>What is Butler Auth?</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a  class="nav-link" href="/docs/about/butler-family" ><span>The Butler family</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link active" href="/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link" href="/community/" ><span>Community</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="off">

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Documentation</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-c43b6569b496f1a6d7d9012ee3bc204f">About</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>1.1: <a href="#pg-114aa820b7022d3152eac3f81cafcf65">Butler Auth</a></li>


    
  
    
    
	
<li>1.2: <a href="#pg-acc029fe89d49d33b8be579dd494b161">The Butler family</a></li>


    
  
    
    
	
<li>1.3: <a href="#pg-060a814a29b90c6effd5c82768bae391">Use cases</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>1.4: <a href="#pg-c1c4b0bd4070c97265b7f6cc1fbeae62">Versions</a></li>


    
  
    
    
	
<li>1.5: <a href="#pg-132c90853aed878831e7a0b0be8a0611">Contribution guidelines</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-52f1c5953ac10399c4e29f61be508f8b">Getting started</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.1: <a href="#pg-c618e389e831f782ae93fff8f1d87e54">Choosing an authentication solution</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2.2: <a href="#pg-7fc8b7cc59b74509e6dbe93ab814176f">Installing Butler Auth</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.2.1: <a href="#pg-9f2113636ed5751a1fe5593b12bf2c5e">Choose a platform</a></li>


    
  
    
    
	
<li>2.2.2: <a href="#pg-43cc3044af2e694924726d2c6031cc10">Installing Butler Auth in a Docker container</a></li>


    
  
    
    
	
<li>2.2.3: <a href="#pg-4f49febb0a95385455ef83a0fef22f5d">Running Butler Auth as a native Node.js application</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2.3: <a href="#pg-0ca932d24ef7acc4ecb76a7069e1c2d6">Setup</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.3.1: <a href="#pg-053f3cb1d8420ee21f26cbb13d26e84d">Which config file to use</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2.3.2: <a href="#pg-bac88f32c74e8cc37275b5a81d415a46">Configuration</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.3.2.1: <a href="#pg-44962f22e645367d4a956f59ee19db3f">Logging</a></li>


    
  
    
    
	
<li>2.3.2.2: <a href="#pg-846986ce860e8dd6ceb896f580890410">Heartbeats</a></li>


    
  
    
    
	
<li>2.3.2.3: <a href="#pg-bd94e8f49d6231cceaec81073affe79f">Docker healthcheck</a></li>


    
  
    
    
	
<li>2.3.2.4: <a href="#pg-1b35e8c7a32a75be01318f733d20a37c">Uptime monitor</a></li>


    
  
    
    
	
<li>2.3.2.5: <a href="#pg-23f12fb666c81e02a5348d38bf638953">REST/web server</a></li>


    
  
    
    
	
<li>2.3.2.6: <a href="#pg-0cee333aa8ccdac46db5d628c60d32f7">Auth providers</a></li>


    
  
    
    
	
<li>2.3.2.7: <a href="#pg-749a6b7629659ae1ad5107529e634169">Qlik Sense</a></li>


    
  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>2.4: <a href="#pg-2d747f24b5c906a8e3d1b48085f5ef0d">Day 2 operations</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-7eee50e5d896d8c0f7761ed471a95d89">Examples</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-aea2e29d74085012eefd7d988e5a3095">Auth providers</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.1: <a href="#pg-2dd318bb013393699bed09b10d39ec61">Auth0</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.1.2: <a href="#pg-4c2d35dca41e25ad21157c2563d38f16">Facebook</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.1.3: <a href="#pg-7abe6c4ab3df159c91026f5614d0e056">Google</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.1.4: <a href="#pg-cd03653be383928caf55ca08e6e255f9">Keycloak</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.1.5: <a href="#pg-8a04f02a952619a29f42052277d25a99">LDAP</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.1.6: <a href="#pg-c22ea6d7a86b36cf6053b0b37a8544b7">Local file</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.1.7: <a href="#pg-2a7aed702615aac0c9d28e8768cc73ce">Microsoft</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.1.8: <a href="#pg-1c49dcbb2c8ad8f0fff0647b2a5f82ab">Okta</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.1.9: <a href="#pg-790dc315439d08eab01dc0331a2ed8b4">Single user</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>3.2: <a href="#pg-e8beb0e1c0074106175db3fa07ba78a9">Customizing the demo site</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.3: <a href="#pg-a14d5cf4b74e46d59695f3d4a0c959e4">Butler Auth is observable</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-b00a88a07ceb21b1a83e5822e0c86c1d">Reference</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-7f7d6f8507fae88d284446932d7bce54">Config file</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4.2: <a href="#pg-bf5246697dc6c6906cb82b681e3668c9">Passport.js</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4.3: <a href="#pg-0cd03205810ca559667d498c383386e0">Images &amp; artwork attribution</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-0e10aa79b66ebaf60284768f9c0d59cf">Security considerations</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-77e780299a8751a6c2387c723d1abb0b">Legal stuff</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>


<div class="content">
      

<div class="pageinfo pageinfo-primary">
<h3 id="version-10">Version 1.0</h3>
<p>This first version of Butler Auth includes support for these authentication providers:</p>
<ul>
<li>Google</li>
<li>Microsoft</li>
<li>Okta</li>
<li>Auth0</li>
<li>Keycloak</li>
<li>Facebook</li>
<li>LDAP</li>
<li>Local file</li>
<li>Single user</li>
</ul>
<p>Docker containers are available on <a href="https://hub.docker.com/r/ptarmiganlabs/butler-auth">Docker Hub</a> for both Intel and ARM architectures.</p>

</div>


</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-c43b6569b496f1a6d7d9012ee3bc204f">1 - About</h1>
    <div class="lead">Information about the Butler Auth software, community, docs and more.</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-114aa820b7022d3152eac3f81cafcf65">1.1 - Butler Auth</h1>
    <div class="lead">An introduction to Butler Auth.</div>
	<p>The goal of the Butler Auth project is to make it easy to add strong/flexible/custom authentication strategies to Qlik Sense Enterprise on Windows (QSEoW).</p>
<p>QSEoW has very good, built-in <em><strong>access control</strong></em> and <em><strong>authorization</strong></em>.<br>
In practice this means that QSEoW enforces that users only can access resources they are allowed to access.</p>
<p>There is however no <em><strong>authentication</strong></em> what so ever in QSEoW.<br>
This is quite reasonable - Qlik Sense is an analytics tool and should focus on this rather than the intricancies of ensuring that users are who they claim to be. That job is better left to those specializing in that particular field.</p>
<p><em><strong>Butler Auth is the link between QSEoW and services that specialize in authentication and security.</strong></em></p>
<h2 id="technology-stack">Technology stack</h2>
<p>Butler Auth is written in <a href="https://nodejs.org/en/">Node.js</a> and runs on most modern operating systems.<br>
Some authentication providers are developed as part of the Butler Auth project, but most come from <a href="/docs/reference/passport.js/">Passport.js</a>.</p>
<p>You can run Butler Auth on the same server as Qlik Sense, in a Docker container on a Linux server, in Kubernetes, on Mac OS, on Raspberry Pi (not a good idea.. but possible and proven to work).</p>
<p>Butler Auth is a member of a group of tools collectively referred to as the &ldquo;Butler family&rdquo;, more info <a href="/docs/about/butler-family">here</a>.</p>
<p>This picture might be useful to understand what Butle Auth does and how it fits into the larger system map around Qlik Sense:</p>
<p><img src="butler-auth-system-overview-1.png" alt="alt text" title="Butler Auth high level system overview"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-acc029fe89d49d33b8be579dd494b161">1.2 - The Butler family</h1>
    <div class="lead">Please meet the Butlers. They&rsquo;re a nice, wild bunch!</div>
	<p>Butler Auth is part of a group of tools that all aim to improve, simplify or extend various aspects of Qlik products.<br>
Most tools focus on Qlik Sense Enterprise on Windows, but some have wider use within the Qlik ecosystem.</p>
<p>All members of the Butler family can be downloaded from Ptarmigan Labs' <a href="https://github.com/ptarmiganlabs">GitHub page</a>.<br>
Development of the Butler tools is sponsored by Ptarmigan Labs AB, which is an IT consultancy company in Stockholm, Sweden.</p>
<p>Projects with production grade release status are (as of this writing):</p>
<h3 id="butler-auth">Butler Auth</h3>
<p>Makes it easier to add strong/flexible/custom authentication flows to Qlik Sense Enterprise on Windows.<br>
Out of the box Butler Auth supports Google, Microsoft, Facebook, Okta, Auth0, LDAP and a few more authentication providers.</p>
<p>Butler Auth is designed to be extensible. It&rsquo;s therefore relatively easy to add new authentication providers.</p>
<p><a href="https:/butler-auth.ptarmiganlabs.com">butler-auth.ptarmiganlabs.com</a> (This site!)</p>
<h3 id="butler">Butler</h3>
<p>The original Butler. Offers various utilities that make it easier to develop Sense apps, as well as simplifying day 2 operations.</p>
<p><a href="https:/butler.ptarmiganlabs.com">butler.ptarmiganlabs.com</a></p>
<h3 id="butler-sos">Butler SOS</h3>
<p>Real-time operational metrics for Qlik Sense.<br>
It simplifies day 2 operations ([<a href="https://www.infoworld.com/article/3442754/why-de-risking-day-2-operations-is-a-smart-business-strategy.html">1</a>], [<a href="https://dzone.com/articles/defining-day-2-operations">2</a>]) and is a must-have if you are responsible for a Sense environment with more than a dozen or so users.</p>
<p>Key features include</p>
<ul>
<li>Storing operational metrics to InfluxDB, for later viewing in Grafana dashboards.</li>
<li>Extract warnings and errors from Sense. Makes it much easier to detect (and act!) on issues as they happen, rather than in retrospect much later.</li>
</ul>
<p><a href="https://butler-sos.ptarmiganlabs.com">butler-sos.ptarmiganlabs.com</a></p>
<h3 id="butler-cw">Butler CW</h3>
<p>Butler Cache Warmer. Cache warming is the process of proactively forcing Sense apps to be loaded into the Sense server&rsquo;s memory, so they are readily available when users open them.</p>
<p>Once again - if your Sense environment serve more than a dozen users, you should consider a cache warming tool.</p>
<p><a href="https://github.com/ptarmiganlabs/butler-cw">github.com/ptarmiganlabs/butler-cw</a></p>
<h3 id="butler-app-duplicator">Butler App Duplicator</h3>
<p>No matter if you are a single developer creating Sense apps, or have lots of developers doing this, having app templates is a good idea:</p>
<ul>
<li>Lowered barrier of entry for new Sense developers.</li>
<li>Productivity boost when developing Sense apps.</li>
<li>Encouraging a common coding style and standard across all apps.</li>
</ul>
<p><a href="https://github.com/ptarmiganlabs/butler-app-duplicator">github.com/ptarmiganlabs/butler-app-duplicator</a></p>
<h3 id="butler-spyglass">Butler Spyglass</h3>
<p>This tool is mainly of interest if you have lots of QVDs and apps, but when that&rsquo;s the case it&rsquo;s of paramount importance to understand what apps use which QVDs. In other words what data lineage looks like.</p>
<p>Butler Spyglass also extracts full load scripts for all Sense apps, creating a historical record of all load scripts for all Sense apps.</p>
<p><a href="https://github.com/ptarmiganlabs/butler-spyglass">github.com/ptarmiganlabs/butler-spyglass</a></p>
<h3 id="butler-notifier">Butler Notifier</h3>
<p>This tool makes it easy to tap into the Qlik Sense notification API. From there you can get all kinds of notifications, including task reload failures and changes in session state (user login/logout etc).</p>
<p><a href="https://github.com/ptarmiganlabs/butler-notifier">github.com/ptarmiganlabs/butler-notifier</a></p>
<h3 id="butler-icon-uploader">Butler Icon Uploader</h3>
<p>Visual looks is important when it comes to analytics, and this holds true also for Sense apps.
The Butler Icon Uploader makes it easy to upload icon libraries (for example Font Awesome) to Qlik Sense Enterprise.<br>
With such icons available, Sense app developers can then use professional quality sheet and app icons in their Sense apps.</p>
<p><a href="https://github.com/ptarmiganlabs/butler-icon-upload">github.com/ptarmiganlabs/butler-icon-upload</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-060a814a29b90c6effd5c82768bae391">1.3 - Use cases</h1>
    <div class="lead">How can Butler Auth be used?</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Disclaimer</h4>

    <p>All your use of Qlik Sense Enterprise on Windows is subject to the licensing and other terms you have received from Qlik.<br>
These may in theory differ between Qlik&rsquo;s customers and also change over time.</p>
<p>You are yourself responsible for complying with terms.</p>
<p>If Butler Auth offers or enables features that do not align with the licesning terms you have received from Qlik, it is still <em>your</em> responsibility to comply with Qlik&rsquo;s terms and conditions.</p>
<p>None of the companies and/or individuals that have at some point contributed to Butler Auth, should at any time, in any way, be held liable for how you use Butler Auth.</p>


</div>

<h3 id="log-into-qseow-using-one-of-the-major-cloud-providers-directory-service">Log into QSEoW using one of the major cloud providers' directory service</h3>
<p>If you already use Microsoft Azure, Google, Okta or Auth0 as identify provider, you probably want to do the same also for Qlik Sense.</p>
<h3 id="log-into-qseow-using-ldap-for-as-both-user-and-credentials">Log into QSEoW using LDAP for as both user and credentials</h3>
<p>A very common setup (possibly <em>the</em> most common) is to use Active Directory for storing user info and credentials, and then talk to AD using the LDAP protocol.</p>
<p>QSEoW natively supports syncing <em>user names</em> from some service using LDAP, this does not include passwords though.<br>
This is actually not authentication at all, it&rsquo;s just a way to sync user names and attributes from a directory service to QSEoW, using the LDAP protocol.</p>
<p>LDAP can however also be used to <em>authenticate</em> users, and Butler Auth supports this.</p>
<p>One use case is thus to get both the Qlik Sense user directory info (i.e. user names and attributes) <em>and</em> authenticate users via LDAP.</p>
<h3 id="authenticate-against-keycloak-for-a-fully-open-source-setup">Authenticate against Keycloak for a fully open source setup</h3>
<p><a href="https://www.keycloak.org/">Keycloak</a> is a very powerful, open source identity provider.</p>
<p>In situations where open source solutions are preferred or mandated the combination of Keycloak and Butler Auth provides a 100% open source authentication solution for QSEoW.</p>
<h3 id="increaseed-redundancy-by-offering-sign-in-via-multiple-channels">Increaseed redundancy by offering sign-in via multiple channels</h3>
<p>If you have multiple authentication solutions Butler Auth can be used to support several (or all) of them.</p>
<p>For example, let&rsquo;s assume Okta is the primary authentication provider in your company but you also use Google&rsquo;s tools (GMail, Sheets, Docs etc).</p>
<p>Butler Auth can then be configured for both Okta and Google authentication, with the effect that users can use either service when logging into Sense.</p>
<h3 id="use-a-single-user-account-for-all-access-to-qseow">Use a single user account for all access to QSEoW</h3>
<p>Sometimes you want all access to Qlik Sense to happen via a specific user account.</p>
<p>Admittedly, this might not be a very common scenario. But consider a trade show or other event where people should be able to test some Qlik Sense based application - ideally without having to log in at all.</p>
<p>You could solve this by using a Qlik Sense license that allows for anonymous users - but that&rsquo;s probably overkill if the purpose is a simple demo event.</p>
<p>Another option is to use Butler Auth to force all access to Sense to use a single Sense account.<br>
Given Sense&rsquo;s limits on number of simultaneous sessions, only a handful (or less) people can try that Sense app at once - but it might be good enough for this specific use case.</p>
<p>Another use case would be to show a dashboard on a set of monitors in the office.</p>
<p><em>January 2021 note: Given how rarely people are in offices nowadays and the non-existing nature of trade shows, the use cases above might be pretty theoretical during coming months/years&hellip;</em></p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c1c4b0bd4070c97265b7f6cc1fbeae62">1.4 - Versions</h1>
    <div class="lead">Features are added, bugs are fixed. How are Butler Auth versions set?</div>
	

<div class="pageinfo pageinfo-primary">
<p>In the spirit of not copying information to several places, the version history is kept as annotations of each release on the <a href="https://github.com/ptarmiganlabs/butler-auth/releases">GitHub release page</a>.</p>
<p>Version numbers include up to 3 levels, for example version 4.6.2 (which is a fictitious version):</p>
<p>4 is the <strong>major</strong> version. It is increased when Butler Auth has added major new features, or in other ways changed in major ways. If following this principle, breaking changes should always result in a bumped major version.</p>
<p>6 is the <strong>minor</strong> version. This indicates a smaller update, when one or a few minor features have been added.</p>
<p>2 is the <strong>patch</strong> level. When individual bugs are fixed, these are released with an increased patch level.</p>
<p>Note 1: Major and minor updates usually include bug fixes too.<br>
Note 2: If a version of 5.2 is mentioned, this implicitly means 5.2.0.</p>

</div>


</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-132c90853aed878831e7a0b0be8a0611">1.5 - Contribution guidelines</h1>
    <div class="lead">How to contribute to Butler Auth.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Butler Auth is an open source project, using the <a href="https://choosealicense.com/licenses/mit/">MIT license</a>.</p>
<p>This means that all source code, documentation etc is available as-is, at no cost.</p>
<p><strong>It however also means that anyone interested can - and is encouraged to - contribute to the project!</strong></p>

</div>

<p>Butler Auth is developed in <a href="https://nodejs.org">Node.js</a>, with support from various <a href="https://www.npmjs.com/">NPM</a> modules.<br>
Specifically, most authentication providers are implemented using <a href="http://www.passportjs.org/">Passport.js</a>.</p>
<p>We use <a href="https://gohugo.io/">Hugo</a> to format and generate this documentation site and the <a href="https://github.com/google/docsy">Docsy</a> theme for styling and site structure.<br>
Hugo is an open-source static site generator that provides us with templates, content organisation in a standard directory structure, and a website generation engine. You write the pages in Markdown (or HTML if you want), and Hugo wraps them up into a website.</p>
<p>All submissions, including submissions by project members, require review.<br>
We use GitHub pull requests for this purpose. Consult <a href="https://docs.github.com/en/free-pro-team@latest/github/collaborating-with-issues-and-pull-requests/about-pull-requests">GitHub Help</a> for more information on using pull requests.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Security/Disclosure</h4>

    If you discover a serious bug with Butler Auth that may pose a security problem, please disclose it confidentially to <a href="mailto:security@ptarmiganlabs.com">security@ptarmiganlabs.com</a> first, so that it can be assessed and hopefully fixed prior to being exploited. Please do not raise GitHub issues for security-related doubts or problems.

</div>

<h2 id="discussions">Discussions</h2>
<p>We use <a href="https://github.com/ptarmiganlabs/butler-auth/discussions/1">GitHub&rsquo;s discussion boards</a> to discuss ideas, features, issues and everything else relating to Butler Auth.</p>
<h2 id="contributing-to-butler-auth-and-this-documentation-site">Contributing to Butler Auth and this documentation site</h2>
<p>Butler Auth itself lives in <a href="https://github.com/ptarmiganlabs/butler-auth">https://github.com/ptarmiganlabs/butler-auth</a>.</p>
<p>The doc site lives in <a href="https://github.com/ptarmiganlabs/butler-auth-docs">https://github.com/ptarmiganlabs/butler-auth-docs</a>.</p>
<h3 id="code-reviews">Code reviews</h3>
<p>All submissions, including submissions by project members, require review. We use GitHub pull requests for this purpose. Consult <a href="https://help.github.com/articles/about-pull-requests/">GitHub Help</a> for more information on using pull requests.</p>
<h3 id="test-your-changes">Test your changes</h3>
<p>As obvious as it might sound: Please test your proposed changes properly before submitting pull requests.</p>
<h3 id="creating-an-issue">Creating an issue</h3>
<p>If you&rsquo;ve found a problem - or have a feature suggestion - with Butler Auth or this documentation site, but you&rsquo;re not sure how to fix it yourself, please create an issue in the <a href="https://github.com/ptarmiganlabs/butler-auth/issues/new">Butler Auth</a> or <a href="https://github.com/ptarmiganlabs/butler-auth-docs/issues/new">Butler Auth docs</a> repos. You can also create an issue about a specific doc page by clicking the <strong>Create project issue</strong> button in the top right hand corner of the page.</p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-52f1c5953ac10399c4e29f61be508f8b">2 - Getting started</h1>
    <div class="lead">What you need to know to get Butler Auth off the ground.</div>
	<h2 id="installation">Installation</h2>
<p>Follow the <a href="/docs/getting-started/install">installation instructions</a> - they will guide through the setup process, including requirements and customisation.</p>
<h2 id="setup">Setup</h2>
<p>Once everything is installed you need to <a href="./setup">edit the configuration file</a> to suit your specific needs.</p>
<h2 id="try-it-out">Try it out!</h2>
<p>Feel free to browse through <a href="/docs/examples">the examples</a> to get an understanding of how Butler Auth can be used.<br>
There are also <a href="https://youtu.be/skdf%C3%B6dsklf">Youtube videos</a> showing Butler Auth in action.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c618e389e831f782ae93fff8f1d87e54">2.1 - Choosing an authentication solution</h1>
    <div class="lead">Authentication is about ensuring people are who they claim to be. This can be done in many ways with their respective pros, cons and security concerns.</div>
	<p>There isn&rsquo;t really any right or wrong here.<br>
What&rsquo;s right for your company might be unacceptable for another company, and vice versa.</p>
<p>This page is intended to make you think and consider the options you have.</p>
<h2 id="commercial-service-or-open-source">Commercial service or open source?</h2>
<p>The authentication providers supported by Butler Auth generally belong to either of two categories:</p>
<ul>
<li>
<p>Commercial identity and authentication providers such as Okta and Auth0.<br>
These companies have entire teams dedicated to creating secure solutions for their customers.
But the transparency is limited or non-existing. They will for sure use open standards like OAuth 2.0, OpenID etc - but you will never know exactly what <em>their</em> specific implementations look like.<br>
In other words: You will never be able to audit the code responsible for your authentication flow - you have to trust that these companies know what they are doing.</p>
</li>
<li>
<p>Open source libraries provide full transparency. You can audit them if/when needed.<br>
The downside is that these libraries are sometimes developed by individuals or companies that no longer actively maintain them. Which in worst case <em>could</em> mean that new security issues are discovered in a standard authentication protocol, but the open source libraries are not quickly updated - or not updated at all.<br>
In this case you&rsquo;d be using a library with security issues associated with it. While this is rare, it&rsquo;s a real possibility.</p>
</li>
</ul>
<h2 id="passportjs">Passport.js</h2>
<p>Butler Auth relies heavily on the <a href="http://www.passportjs.org/packages/">authentication strategies</a> available via <a href="http://www.passportjs.org/">Passport.js</a>.</p>
<p>This is an open source authentication library boasting 500+ various kinds of authentication strategies.</p>
<p>Now, there will be some duplicates (for example several different Passport.js strategies offering Google authentication) and most of those 500+ strategies will be rather obscure - with the associated risk of not being supported.<br>
The big ones - Google, Microsoft, generic OAuth 2.0, Auth0, LDAP, OpenID etc - are generall well supported and kept up to date.<br>
For that reason they are also used in Butler Auth.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Note!</h4>

    <p>If you do not trust the various authentication modules that are part of Passport.js, you should not use them via Butler Auth.</p>
<p>Butler Auth is simply a thin wrapper around those modules.</p>


</div>

<h2 id="recommendation">Recommendation</h2>
<p>So how should you reason if you have the luxury of deciding yourself what authentication solution to use?</p>
<ul>
<li>
<p>If low cost and ease of setup is the main focus you should go with the big, established service providers. Google, Microsoft, GitHub, Amazon etc. By using open source authentication modules you won&rsquo;t have any cost for the software or service.<br>
These are reasonably easy to set up and get working.</p>
</li>
<li>
<p>If you have high security requirements and prefer (or must use) open source, Keycloak is a good option.</p>
<p>Keycloak can however be challenging to set up properly, at least if you also want to lock it down to meet specific security requirements. It&rsquo;s like a Swiss army knife of authentication, with many, many tools in it&hellip;<br>
There is simply a risk of configuring it incorrectly and not achieve the desired security level as a result.</p>
</li>
<li>
<p>If you can accept some costs associated with authentication you could use one of the commercial services.
With some of them you can still use Google/Microsoft/&hellip; authentication if so desired, but you offload that integration work to the service provider.</p>
</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-7fc8b7cc59b74509e6dbe93ab814176f">2.2 - Installing Butler Auth</h1>
    <div class="lead">How to install Butler Auth, including requirements and on what platforms it can be installed.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Given the cross platform nature of Node.js (which is the language Butler Auth is written in), Butler Auth can run on lots of different hardware platforms and operating systems.</p>
<p>It is therefore difficult to give detailed installation instructions for each possible installation scenario. This site thus tries to explain how to get started with Butler Auth in some of the most common scenarios.</p>

</div>

<h2 id="getting-started">Getting started</h2>
<p>Sorry - there is no installer for Butler Auth.<br>
You will need to work a bit on the command line to set things up.</p>
<p>It&rsquo;s not as bad as it sounds though, the instructions here should help you to get started.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Either you install a few pieces of software (most notably <a href="https://nodejs.org/en/">Node.js</a> and some node modules), or you run Butler Auth in a Docker container.</p>
<p>Either way you also need to edit Butler Auth&rsquo;s configuration file and provide certificates exported from Qlik Sense Enterprise.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9f2113636ed5751a1fe5593b12bf2c5e">2.2.1 - Choose a platform</h1>
    <div class="lead">On what platforms does Butler Auth run?</div>
	<p>If you have access to or can set up a <strong>Docker</strong> runtime environment, this is by far the preferred way of running Butler Auth.</p>
<p>Installation is less error prone compared to installing Butler Auth as a <strong>Node.js app</strong>, you get all the benefits from the Docker ecosystem (monitoring of running containers etc), and upgrades to future Butler Auth ersions become trivial.</p>
<p>If you have access to a <strong>Kubernetes</strong> cluster, that is usually an even better option than Docker. Kubernetes can be daunting when first approached, but will give you superb reliability, failover and restarts if a server goes down or becomes unresponsive etc.</p>
<p><a href="https://k3s.io/">Rancher&rsquo;s K3s</a> is a great way to get started with Kubnernetes. Fully featured, well supported and a vibrant developer community.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-43cc3044af2e694924726d2c6031cc10">2.2.2 - Installing Butler Auth in a Docker container</h1>
    <div class="lead">How to install Butler Auth as a Docker container.</div>
	<p>Prerequisites for running Butler Auth in Docker:</p>
<table>
<thead>
<tr>
<th>What</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Qlik Sense Enterprise on Windows</td>
<td><em>Mandatory.</em> Butler Auth is developed with Qlik Sense Enterprise on Windows in mind.</td>
</tr>
<tr>
<td>Docker</td>
<td><em>Mandatory.</em> A Docker runtime environment on any supported platform. This means you can run Butler Auth on any platform where Docker is available, including Linux, Mac OS, Windows and most cloud providers. Kubernetes is also a great option for running Butler Auth!</td>
</tr>
<tr>
<td><a href="https://www.influxdata.com/time-series-platform/">InfluxDB</a></td>
<td><em>Optional.</em> A database for realtime information, used to store metrics around Butler&rsquo;s own memory usage over time (if this feature is enabled).</td>
</tr>
</tbody>
</table>
<h2 id="installation-steps">Installation steps</h2>
<p>The following steps give some guidance on how to get Butler Auth running on Docker.<br>
Here Mac OS has been used, things will look different on Linux and Windows.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">➜  ~ mkdir /Users/goran/butler-auth
➜  ~ <span style="color:#204a87">cd</span> /Users/goran/butler-auth
➜  butler-auth mkdir -p config/certificate
➜  butler-auth mkdir sessions
➜  butler-auth mkdir log
➜  butler-auth wget https://raw.githubusercontent.com/ptarmiganlabs/butler-auth/main/src/docker-compose.yaml
--2021-01-20 13:58:54--  https://raw.githubusercontent.com/ptarmiganlabs/butler-auth/main/src/docker-compose.yaml
Resolving raw.githubusercontent.com <span style="color:#ce5c00;font-weight:bold">(</span>raw.githubusercontent.com<span style="color:#ce5c00;font-weight:bold">)</span>... 151.101.128.133, 151.101.64.133, 151.101.192.133, ...
Connecting to raw.githubusercontent.com <span style="color:#ce5c00;font-weight:bold">(</span>raw.githubusercontent.com<span style="color:#ce5c00;font-weight:bold">)</span><span style="color:#000;font-weight:bold">|</span>151.101.128.133<span style="color:#000;font-weight:bold">|</span>:443... connected.
HTTP request sent, awaiting response... <span style="color:#0000cf;font-weight:bold">200</span> OK
Length: <span style="color:#0000cf;font-weight:bold">754</span> <span style="color:#ce5c00;font-weight:bold">[</span>text/plain<span style="color:#ce5c00;font-weight:bold">]</span>
Saving to: ‘docker-compose.yaml’

docker-compose.yaml                                                   100%<span style="color:#ce5c00;font-weight:bold">[========================================================================================================================================================================</span>&gt;<span style="color:#ce5c00;font-weight:bold">]</span>     <span style="color:#0000cf;font-weight:bold">754</span>  --.-KB/s    in 0s

2021-01-20 13:58:54 <span style="color:#ce5c00;font-weight:bold">(</span>37.8 MB/s<span style="color:#ce5c00;font-weight:bold">)</span> - ‘docker-compose.yaml’ saved <span style="color:#ce5c00;font-weight:bold">[</span>754/754<span style="color:#ce5c00;font-weight:bold">]</span>

➜  butler-auth
➜  butler-auth cat docker-compose.yaml
<span style="color:#8f5902;font-style:italic"># docker-compose.yml</span>
version: <span style="color:#4e9a06">&#39;3.3&#39;</span>
services:
  butler-auth:
    image: ptarmiganlabs/butler-auth:1.0.0
    container_name: butler-auth
    restart: always
    ports:
      - <span style="color:#4e9a06">&#34;8081:8081&#34;</span>       <span style="color:#8f5902;font-style:italic"># http/web server used to serve sample login forms included in Butler Auth</span>
      - <span style="color:#4e9a06">&#34;8761:8761&#34;</span>       <span style="color:#8f5902;font-style:italic"># REST API called by Qlik Sense Enterprise when users should be authenticated</span>
    volumes:
      <span style="color:#8f5902;font-style:italic"># Make config file and logs accessible outside of container</span>
      - <span style="color:#4e9a06">&#34;./config:/nodeapp/config&#34;</span>
      - <span style="color:#4e9a06">&#34;./log:/nodeapp/log&#34;</span>
      - <span style="color:#4e9a06">&#34;./sessions:/nodeapp/sessions&#34;</span>
      - <span style="color:#4e9a06">&#34;/path/to/tls/cert:/nodeapp/config/tls&#34;</span>
    environment:
      - <span style="color:#4e9a06">&#34;NODE_ENV=production&#34;</span>
    logging:
      driver: json-file
      options:
        max-file: <span style="color:#4e9a06">&#34;5&#34;</span>
        max-size: <span style="color:#4e9a06">&#34;5m&#34;</span>
➜  butler-auth
</code></pre></div><p>At this point you should</p>
<ol>
<li>Export certificates from the Qlik Sense QMC. Export a full set of certificates in PEM format, with or without passwords on the certificates. If a password is used it must also be specified in Butler Auth&rsquo;s config file.</li>
<li>Copy the certificates to the ./config/certificate directory.</li>
<li>Copy the <a href="https://github.com/ptarmiganlabs/butler-auth/blob/master/src/config/production_template.yaml">template config file</a> from the GitHub repository to the ./config directory, modify it as needed based on your system(s) and which Butler Auth features you want enabled.<br>
Rename it to for example <code>production.yaml</code>.<br>
You can actually name the config file anything, but its name has to match the NODE_ENV environment variable, as set it the <code>docker-compose.yaml</code> file.</li>
<li>If using the <code>local-file</code> auth provider, you also need a corresponding YAML file where user info is stored. There is a <a href="https://github.com/ptarmiganlabs/butler-auth/blob/master/src/config/users.yaml">template file</a> in the GitHub repository.</li>
<li>If using TLS to secure Butler Auth (you should!), the volumes entry <code>/path/to/tls/cert:/nodeapp/config/tls</code> in <code>docker-compose.yaml</code> must point to your TLS certificates.</li>
</ol>
<p>When done, you should see something like this:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">➜  butler-auth tree
.
├── config
│   ├── certificate
│   │   ├── client.pem
│   │   ├── client_key.pem
│   │   └── root.pem
│   ├── production.yaml
│   └── users.yaml
├── docker-compose.yaml
├── log
└── sessions

<span style="color:#0000cf;font-weight:bold">4</span> directories, <span style="color:#0000cf;font-weight:bold">6</span> files
➜  butler-auth
</code></pre></div><p>At this point everything is ready and you can start the Butler Auth container using docker-compose (IP addresses and URLs have been slightly scrambled below):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">➜  butler-auth docker-compose up
Creating network <span style="color:#4e9a06">&#34;butler-auth_default&#34;</span> with the default driver
Pulling butler-auth <span style="color:#ce5c00;font-weight:bold">(</span>ptarmiganlabs/butler-auth:1.0.0<span style="color:#ce5c00;font-weight:bold">)</span>...
1.0.0: Pulling from ptarmiganlabs/butler-auth
22f9b9782fc3: Already exists
072739d44e4f: Already exists
5111f27e9600: Already exists
dc22afea6082: Already exists
0ad0b403cda0: Already exists
bca65cadbc25: Already exists
c1e57ccc1a03: Already exists
2571476d0e73: Already exists
e3719000bb2c: Already exists
d09cb7e3b7d4: Pull <span style="color:#204a87">complete</span>
76d111860f8b: Pull <span style="color:#204a87">complete</span>
c30b9b6a8b26: Pull <span style="color:#204a87">complete</span>
e75f642798c7: Pull <span style="color:#204a87">complete</span>
5b06a9fb8f94: Pull <span style="color:#204a87">complete</span>
Digest: sha256:545e81b4a638cb2f50b7718723cd60528e91a237349429279a90928c95fa420f
Status: Downloaded newer image <span style="color:#204a87;font-weight:bold">for</span> ptarmiganlabs/butler-auth:1.0.0
Creating butler-auth ... <span style="color:#204a87;font-weight:bold">done</span>
Attaching to butler-auth
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.070Z info: CONFIG: Influxdb enabled: <span style="color:#204a87">true</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.075Z info: CONFIG: Influxdb host IP: 1.2.3.4
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.075Z info: CONFIG: Influxdb host port: <span style="color:#0000cf;font-weight:bold">8086</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.076Z info: CONFIG: Influxdb db name: butlerauth
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.413Z info: AUTH-LOCALFILE: Setting up endpoints.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.415Z info: AUTH-LOCALFILE: Loading user list.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.419Z info: AUTH-LOCALFILE: Successfully loaded users from file.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.420Z debug: AUTH-LOCALFILE: Users loaded from file: <span style="color:#ce5c00;font-weight:bold">[</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span>   <span style="color:#ce5c00;font-weight:bold">{</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;username&#34;</span>: <span style="color:#4e9a06">&#34;anna&#34;</span>,
butler-auth    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;fullName&#34;</span>: <span style="color:#4e9a06">&#34;Anna Svenson&#34;</span>,
butler-auth    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;password&#34;</span>: <span style="color:#4e9a06">&#34;aaa&#34;</span>,
butler-auth    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;comment&#34;</span>: <span style="color:#4e9a06">&#34;Root admin user&#34;</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span>   <span style="color:#ce5c00;font-weight:bold">}</span>,
butler-auth    <span style="color:#000;font-weight:bold">|</span>   <span style="color:#ce5c00;font-weight:bold">{</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;username&#34;</span>: <span style="color:#4e9a06">&#34;joe&#34;</span>,
butler-auth    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;fullName&#34;</span>: <span style="color:#4e9a06">&#34;Joe Jonson&#34;</span>,
butler-auth    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;password&#34;</span>: <span style="color:#4e9a06">&#34;bbb&#34;</span>,
butler-auth    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;comment&#34;</span>: <span style="color:#4e9a06">&#34;Regular user&#34;</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span>   <span style="color:#ce5c00;font-weight:bold">}</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span> <span style="color:#ce5c00;font-weight:bold">]</span>
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.421Z info: AUTH-LDAP: Setting up endpoints.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.421Z info: AUTH-GOOGLEOAUTH: Setting up endpoints.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.422Z info: AUTH-FACEBOOK: Setting up endpoints.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.423Z info: AUTH-MICROSOFT: Setting up endpoints.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.424Z info: AUTH-OKTA: Setting up endpoints.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.425Z info: AUTH-KEYCLOAK: Setting up endpoints.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.425Z info: AUTH-AUTH0: Setting up endpoints.
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.426Z debug: HEARTBEAT: Setting up heartbeat to remote: http://healthcheck.mycompany.com/ping/12345678-1234-1234-1234-b10b81583522
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.428Z info: --------------------------------------
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.428Z info: Starting Butler authenticator
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.428Z info: Log level: debug
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.428Z info: App version: 1.0.0
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.428Z info: --------------------------------------
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.458Z info: MAIN: REST server now listening on butler-auth:8761
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.459Z info: MAIN: Web server now listening on butler-auth:8081
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.478Z info: CONFIG: Found InfluxDB database: butlerauth
butler-auth    <span style="color:#000;font-weight:bold">|</span> 2021-01-19T06:22:18.597Z debug: HEARTBEAT: Sent heartbeat to http://healthcheck.mycompany.com/ping/12345678-1234-1234-1234-b10b81583522

</code></pre></div><p>What you see on your screen will depend on which Butler Auth version you are using and what features are enabled.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4f49febb0a95385455ef83a0fef22f5d">2.2.3 - Running Butler Auth as a native Node.js application</h1>
    <div class="lead">How to install Butler Auth as a Node.js application.</div>
	<p>While Qlik Sense Enterprise is a Windows only system, Butler Auth runs on any OS where Node.js is available.<br>
Butler Auth has been succesfully used using standard Node.js - during development and production - on Windows, Linux (Debian and Ubuntu tested) and Mac OS.</p>
<h2 id="running-as-nodejs-app">Running as Node.js app</h2>
<p>Prerequisites:</p>
<table>
<thead>
<tr>
<th>What</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sense Enterprise</td>
<td><em>Mandatory.</em> Butler Auth is developed with Qlik Sense Enterprise on Windows in mind.</td>
</tr>
<tr>
<td><a href="https://nodejs.org">Node.js</a></td>
<td><em>Mandatory.</em></td>
</tr>
<tr>
<td><a href="https://www.influxdata.com/time-series-platform/">InfluxDB</a></td>
<td><em>Optional.</em> A database for realtime information, used to store metrics around Butler Auth&rsquo;s own memory usage over time (if this feature is enabled).</td>
</tr>
</tbody>
</table>
<h2 id="installation-steps">Installation steps</h2>
<ul>
<li>
<p><strong>Install node.js</strong><br>
Butler Auth was developed and tested using the 64 bit version of <a href="https://nodejs.org/en/download/">Node.js</a>. The most recent LTS (Long Term Support) version of Node.js is a good choice for running Butler. At time of this writing, Node.js 14.5 is used.</p>
</li>
<li>
<p><strong>Decide where to install Butler Auth</strong><br>
It is usually a good starting point to run Butler Auth on a Sense server.</p>
<p>On the other hand, you might want to keep the Sense servers as clean as possible (with respect to software running on them). If that is a priority you should install Butler Auth on some other server. A small &ldquo;utility&rdquo; or &ldquo;misc&rdquo; server can often be useful for running various add-on services to Qlik Sense.</p>
<p>The bottom line is that Butler Auth can run on any server, as long as Node.js is available and there is network connectivity to the actual Qlik Sense server(s).</p>
</li>
<li>
<p><strong>Download Butler Auth</strong><br>
Download the repository zip from the <a href="https://github.com/ptarmiganlabs/butler-auth/releases">releases page</a> file or clone the Butler Auth repository using your git tool of choice. Both options achieve the same thing, i.e. a directory such as d:\node\butler-auth, which is then Butler Auth&rsquo;s root directory.</p>
</li>
<li>
<p><strong>Install node dependencies</strong><br>
From a Windows command prompt (assuming the Butler ZIP file/repository was extracted to d:\node\butler-auth):</p>
<pre><code>d:
cd \node\butler-auth\src
npm install
</code></pre>
<p>This will download and install the Node.js modules used by Butler Auth.</p>
</li>
<li>
<p><strong>Configuration</strong><br>
Configuration of Butler Auth is done more or less the same way as <a href="/docs/getting-started/install/docker/#installation-steps">configuring for Docker</a>, i.e. get certificates from Qlik Sense Enterprise on Windows &gt; store them in suitable location &gt; refer to those cert files from <code>production.yaml</code> file etc.<br>
More details are then available in the on the <a href="/docs/getting-started/setup/config-file">Configuration pages</a>.</p>
</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0ca932d24ef7acc4ecb76a7069e1c2d6">2.3 - Setup</h1>
    <div class="lead">Everything you wanted to know about Butler Auth configuration but never dared to ask.</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-053f3cb1d8420ee21f26cbb13d26e84d">2.3.1 - Which config file to use</h1>
    <div class="lead">Butler Auth can be configured using different config files. Here you learn to control which one is used.</div>
	<p>A description of the config file format is available <a href="/docs/reference/config-file/">here</a>.</p>
<h2 id="select-which-config-file-to-use">Select which config file to use</h2>
<p>Butler Auth uses configuration files in <a href="https://en.wikipedia.org/wiki/YAML">YAML</a> format. The config files are stored in the <code>src/config</code> folder.</p>
<p>Trying to run Butler Auth with the default config file (the one included in the files download from GitHub) will not work - you need to adapt it to your server environment.</p>
<p>The name of the config file matters. Butler Auth looks for an environment variable called &ldquo;NODE_ENV&rdquo; and then tries to load a config file named with the value found in NODE_ENV.</p>
<p>For example:</p>
<ul>
<li>
<p>NODE_ENV=production</p>
</li>
<li>
<p>Butler will look for a config file <code>config/production.yaml</code>.</p>
</li>
</ul>
<h3 id="setting-environment-variables">Setting environment variables</h3>
<p>The method for setting environment variables varies between different operating systems:</p>
<p>On Windows:</p>
<pre><code>set NODE_ENV=production
</code></pre>
<p>Mac OS or Linux</p>
<pre><code>export NODE_ENV=production
</code></pre>
<p>If using Docker, the NODE_ENV environment varible is set in the docker-compose.yml file (as already done in the <a href="https://github.com/ptarmiganlabs/butler-auth/blob/master/src/docker-compose.yaml">sample docker-compose file</a>.)</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bac88f32c74e8cc37275b5a81d415a46">2.3.2 - Configuration</h1>
    <div class="lead">Instructions for configuring the different parts of the Butler Auth config file.</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-44962f22e645367d4a956f59ee19db3f">2.3.2.1 - Logging</h1>
    <div class="lead">Logging can be done to disk and/or console, with customisable logging levels and location of log files.</div>
	

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Mandatory</h4>

    <p>These settings are mandatory.</p>
<p>While logging to disk files is optional, logging to console will always happen.<br>
You should also set a log level.</p>
<p>Do note though that Butler expects the configuration properties below to exist in the config file, but will <em>ignore their values</em> if the related features are disabled.</p>


</div>

<h2 id="whats-this">What&rsquo;s this?</h2>
<p>Logging tells you what Butler Auth has done in the past.<br>
Who logged in when, if you like.</p>
<p>Temporarily increasing logging verbosity can also be very useful when setting up new authentication providers.<br>
Don&rsquo;t forget to dial back the logging level once everthing works though!</p>
<h2 id="settings-in-config-file">Settings in config file</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ButlerAuth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Logging configuration</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">logLevel</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">info     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Log level. Possible log levels are silly, debug, verbose, info, warn, error</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">fileLogging</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># true/false to enable/disable logging to disk file</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">logDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Subdirectory where log files are stored. Absolute or relative path accepted.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-846986ce860e8dd6ceb896f580890410">2.3.2.2 - Heartbeats</h1>
    <div class="lead">Heartbeats provide a way to monitor that Butler Auth is running and working as intended.<br>
Butler can send periodic heartbeat messages to a monitoring tool, which can then alert if Butler Auth hasn&rsquo;t checked in as expected.</div>
	

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Optional</h4>

    <p>These settings are optional.</p>
<p>If you don&rsquo;t need this feature just disable it and leave the default values in the config as they are.</p>
<p>Do note though that Butler Auth expects the configuration properties below to exist in the config file, but will <em>ignore their values</em> if the related features are disabled.</p>


</div>

<h2 id="whats-this">What&rsquo;s this?</h2>
<p>A tool like Butler Auth should be viewed as mission critical, at least if the Qlik Sense environment as such is considered mission critical.</p>
<p>But how can you know whether Butler Auth itself is working?<br>
Somehow Butler Auth itself should be monitored.</p>
<p>Butler Auth (and most other tools in the Butler family) has a <strong>heartbeat</strong> feature.<br>
It sends periodic messages to a monitoring tool, which can then alert if Butler hasn&rsquo;t checked in as expected.</p>
<p><a href="https://healthchecks.io/">Healthchecks.io</a> is an example of such as tool. It&rsquo;s open source but also has a SaaS option if so preferred. Highly recommended!</p>
<p>More info on using Healthchecks.io with the Butler family can be found <a href="https://ptarmiganlabs.com/blog/2020/07/26/black-box-monitoring-of-butler-tools-monitoring-the-monitor/">in this blog post</a>.</p>
<h2 id="settings-in-main-config-file">Settings in main config file</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">Butler</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Heartbeats can be used to send &#34;I&#39;m alive&#34; messages to any other tool, e.g. a infrastructure monitoring tool</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># The concept is simple: The remoteURL will be called at the specified frequency. The receiving tool will then know </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># that Butler Auth is alive.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">heartbeat</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># Enable/disable healthcheck pings</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">remoteURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://my.monitoring.server/some/path/</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">frequency: frequency</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">60000</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># Milliseconds</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bd94e8f49d6231cceaec81073affe79f">2.3.2.3 - Docker healthcheck</h1>
    <div class="lead">Docker has a concept of &ldquo;health checks&rdquo;, which is a way for Docker containers to tell the Docker runtime engine that the container is alive and well.
Butler can be configured to send such health check messages to Docker.</div>
	

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Optional</h4>

    <p>These settings are optional.</p>
<p>If you don&rsquo;t need this feature just disable it and leave the default values in the config as they are.</p>
<p>Do note though that Butler Auth expects the configuration properties below to exist in the config file, but will <em>ignore their values</em> if the related features are disabled.</p>


</div>

<p>Note: Sending health check messages is only meaningful when running Butler Auth as a Docker container.</p>
<h2 id="settings-in-main-config-file">Settings in main config file</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">Butler</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Docker health checks are used when running Butler Auth as a Docker container. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># The Docker engine will call the container&#39;s health check REST endpoint with a set interval to determine</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># whether the container is alive/well or not.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># If you are not running Butler Auth in Docker you can safely disable this feature. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">dockerHealthCheck</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Control whether a REST endpoint will be set up to serve Docker health check messages</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">12398</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># Port the Docker health check service runs on (if enabled)</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1b35e8c7a32a75be01318f733d20a37c">2.3.2.4 - Uptime monitor</h1>
    <div class="lead">Butler Auth can optionally log how long it&rsquo;s been running and how much memory it uses.
The memory usage can also (optionally) be stored to an InfluxDB database, for later viewing/alerting in for example a Grafana dashboard.</div>
	

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Optional</h4>

    <p>These settings are optional.</p>
<p>If you don&rsquo;t need this feature just disable it and leave the default values in the config as they are.</p>
<p>Do note though that Butler Auth expects the configuration properties below to exist in the config file, but will <em>ignore their values</em> if the related features are disabled.</p>


</div>

<h2 id="whats-this">What&rsquo;s this?</h2>
<p>In some cases - especially when investigating issues or bugs - it can be useful to get log messages telling how long Butler Auth has been running and how much memory it uses.</p>
<p>This feature is called &ldquo;uptime monitoring&rdquo; and can be enabled in the main config file.</p>
<p>The logging interval is configurable, as is the log level required for uptime messages to be shown.</p>
<p>The memory usage data can optionally be written to InfluxDB, from where it can later be viewed in Grafana.<br>
If the specified InfluxDB database does not exist it will be created. The same is true for the retenion policy.</p>
<p>Select a reasonable retention policy and logging frequency!<br>
You will rarely if ever need to know how much memory Butler Auth used a month ago&hellip; A retention policy of 1-2 weeks is usually a good start, with logging every few minutes.</p>
<h2 id="settings-in-main-config-file">Settings in main config file</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">Butler</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Uptime monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">uptimeMonitor</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Should uptime messages be written to the console and log files?</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">frequency</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">300000</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># Milliseconds</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">logLevel</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">info                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Starting at what log level should uptime messages be shown?</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">storeInInfluxdb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hostIP</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;IP or host name&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">hostPort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8086</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">auth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">user_joe</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">joesecret</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">dbName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">butlerauth</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">instanceTag</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DEV             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Tag that can be used to differentiate data from multiple Butler Auth instances</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># Default retention policy that should be created in InfluxDB when Butler Auth creates a new database there. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># Any data older than retention policy threshold will be purged from InfluxDB.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">retentionPolicy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10d</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">duration</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10d</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-23f12fb666c81e02a5348d38bf638953">2.3.2.5 - REST/web server</h1>
    <div class="lead">How to configre up the REST and web servers that Butler Auth manage.</div>
	

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Mandatory</h4>

    <p>These settings are mandatory.</p>
<p>Do note though that Butler Auth expects the configuration properties below to exist in the config file, but will <em>ignore their values</em> if the related features are disabled.</p>


</div>

<h2 id="whats-this">What&rsquo;s this?</h2>
<p>Butler Auth exposes a REST server which Qlik Sense will call when a user connects to a Qlik Sense virtual proxy.<br>
There are then different REST API endpoints for different authentication providers.
The REST server is also responding to the callbacks that happen as part of for example an OAuth 2.0 authentication flow. When the authentication provider has given green light, that provider&rsquo;s callback endpoint on the REST server is called.</p>
<p>Secondly, a http server is used to serve a sample web based login interface.<br>
This web site is for inspiration only. It has hard coded URLs that need to be changed before it is useful in your own environment. Still, it can serve as a basis for your own, custom/branded login page for Qlik Sense.<br>
Each authentication provider that rely on some kind of web interface for entering user name and password has a <code>url</code> property the main YAML config file (for example <code>ButlerAuth.authProvider.ldap.url</code>). Those property can be used to direct authentication requests to your own, custom login user interfaces.</p>
<p>The settings below control the behvaiour of those two servers.</p>
<h2 id="settings-in-main-config-file">Settings in main config file</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ButlerAuth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Server and https settings</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">server</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">rest</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># The REST server is the authentication server called by Qlik Sense.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN&gt;         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Hostname of the REST server. Would be container name when running under Docker, otherwise something like qliksenseauth.mydomain.com.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8761</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Port where the REST server will listen</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">rateLimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Used to limit number of authentication requests during a given time window. Used to prevent brute forcing attacks.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># Enable/disable rate limiting for this REST API. true/false.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">windowSize</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">60000</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># How long (milliseconds) is the time window we&#39;re capping # of logins for? Default 5 min if not specified.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">maxCalls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># Max # of logins from Qlik Sense during time window above. Default 100 if not specified.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># Many 3rd party auth providers require the OAuth 2 server to use https. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># Enable/disable https. While always recommended, https is strictly not needed for local file authentication, for example.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">cert</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/certfile.cer   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># TLS certificate file </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/certfile.key    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># TLS key file</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># Passphrase for TLS key file, if used</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">web</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># The web/http server used to serve the sample login pages included in Butler Auth</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN&gt;         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># FQDN of the http server </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8081</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Port where the http server will listen</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                  </span><span style="color:#8f5902;font-style:italic"># Used to secure the http server with TLS. I.e. https.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">cert</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/certfile.cer</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/certfile.key</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0cee333aa8ccdac46db5d628c60d32f7">2.3.2.6 - Auth providers</h1>
    <div class="lead">How to configure the authentication providers.</div>
	

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Mandatory</h4>

    <p>These settings are mandatory.</p>
<p>You could in theory disable all the authentication providers, but then you don&rsquo;t need Butler Auth to begin with.</p>
<p>In other words: Enable at least one provider.</p>


</div>

<h2 id="whats-this">What&rsquo;s this?</h2>
<p>A core concept of Butler Auth is that of <em>authentication providers</em>, or just providers.</p>
<p>A provider&rsquo;s purpose is to offer a way to authenticate users.<br>
Once users are authenticated they are forwarded to Qlik Sense.</p>
<p>Providers can be individually enabled and disabled, i.e. there are no dependencies between providers.<br>
Likewise, there are no limitations on how many or which providers can be enabled at the same time.</p>
<p>Each provider has it&rsquo;s own settings in the config file.<br>
If new providers are added to Butler Auth they will need to be configured in the config file.</p>
<h2 id="settings-in-main-config-file">Settings in main config file</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ButlerAuth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Auth providers are responsible for authenticating users before they are forwarded to Qlik Sense Enterprise.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">authProvider</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">       
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">localFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># &#34;Local file&#34; provider reads user data from a file on disk</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                    
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://&lt;FQDN&gt;:8081         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># URL where login UI for this provider is available</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">./config/users.yaml    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># YAML file containing usernames and passwords</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">ldap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                               </span><span style="color:#8f5902;font-style:italic"># &#34;LDAP&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://&lt;FQDN&gt;:8081         </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># URL where login UI for this provider is available</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab               </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">ldapServer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># Information about the LDAP server to authenticate against</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;ldap(s)://ldap.mydomain.com&gt;   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Both normal (ldap://) and secure (ldaps://) LDAP is supported</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">636</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># Usually 389 for LDAP and 636 for LDAPS</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">bindUser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;domain\username&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># Service account used to log into the LDAP server</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">bindPwd</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;password&gt;            </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Password of service account</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">searchBase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;dc=...,dc=...,dc=...&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Base path from which authentication attempts will start</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">searchFilter</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;(&amp;(objectcategory=person)(objectclass=user)(|(samaccountname={{username}})(mail={{username}})))&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Filter used to get info about users in LDAP server</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># Settings here will override default TLS behaviour. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># Useful for example if your cert is for another domain wrt the host name of the LDAP server.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># If a setting is empty it will simply be ignored by Butler Auth.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># Necessary if the LDAP server isusing a self-signed certificate</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#8f5902;font-style:italic"># Should point to a PEM coded CA certificate file.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:bold">ca</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">singleUser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># &#34;Single user&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">goran                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># A user that already exists in QLik Sense. All access to Sense will be done using this user.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">google</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># &#34;Google&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">facebook</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># &#34;Facebook&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">microsoft</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># &#34;Microsoft&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">okta</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                             </span><span style="color:#8f5902;font-style:italic"># &#34;Okta&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">oktaDomain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Okta domain from Google admin console&gt; </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.q. https://myid-123456.okta.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">idp</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">keycloak</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># &#34;Keycloak&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN of Keycloak server&gt;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">realm</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># E.g. ptarmiganlabs</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">authorizationURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/auth</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">tokenURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/token</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userInfoURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/userinfo</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">auth0</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                            </span><span style="color:#8f5902;font-style:italic"># &#34;Auth0&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">issuerBaseURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN&gt;          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. mycompany.eu.auth0.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">baseURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># FQDN of Butler Auth, e.g. https://qliksenseauth.mycompany.com:8761&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-749a6b7629659ae1ad5107529e634169">2.3.2.7 - Qlik Sense</h1>
    
	

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Mandatory</h4>

    These settings are mandatory.

</div>

<h2 id="whats-this">What&rsquo;s this?</h2>
<p>These settings tell Butler Auth where to find the certificates it needs to communicate with Qlik Sense Enterprise.</p>
<h2 id="settings-in-main-config-file">Settings in main config file</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">ButlerAuth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Settings relating to Qlik Sense</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">qlikSense</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Certificates to use when calling Sense APIs. Get these from the Certificate Export in QMC.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">certFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># If running under Docker, use these paths:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># clientCert: /nodeapp/config/certificate/client.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># clientCertKey: /nodeapp/config/certificate/client_key.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># clientCertCA: /nodeapp/config/certificate/root.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># If running as a native Node.js app, point to where the cert files are stored:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientCert</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/client.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientCertKey</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/client_key.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientCertCA</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/root.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">clientCertPassphrase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div>
</div>



    
	
  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2d747f24b5c906a8e3d1b48085f5ef0d">2.4 - Day 2 operations</h1>
    <div class="lead">How to run Butler Auth once its been set up.</div>
	<h2 id="running-butler-auth">Running Butler Auth</h2>
<p>How to start and keep Butler Auth running varies depending on whether you are using Docker or a native Node.js approach.</p>
<h3 id="running-as-a-docker-container">Running as a Docker container</h3>
<p>Starting Butler Auth is easy.<br>
First configure the <code>docker-compose.yml</code> file as needed, then start the Docker container in interactive mode (with output sent to the screen). This is useful to ensure everything works as intended when first setting up Butler Auth.</p>
<pre><code>docker-compose up
</code></pre>
<p>Once everything works as intended, hit <code>ctrl-c</code> to stop the service.<br>
Then start it again in deameon (background) mode:</p>
<pre><code>docker-compose up -d
</code></pre>
<p>From here on the Docker enviromment will make sure Butler is always running, including restarting it if it for some reason stops.</p>
<h3 id="running-as-native-nodejs-app">Running as native Node.js app</h3>
<p>Starting Butler Auth as a Node.js task is easy too:</p>
<pre><code>d:
cd \node\butler-auth\src
node index.js
</code></pre>
<p>It is of course also possible to put those commands in a command file (.bat on Windows, .sh etc on other platforms) file and execute that file instead.</p>
<h4 id="windows-services--process-monitors">Windows services &amp; process monitors</h4>
<p>As Butler Auth is the kind of service that (probably) should always be running on a server, it makes sense using a Node.js process monitor to keep it alive (if running as a Docker container you get this for free).</p>
<p>On Windows you can use the excellent <a href="https://nssm.cc/">Nssm</a> tool to make Butler Auth run as a Windows Service, with all the benefits that follow (can be monitored using operations tools, automatic restarts etc).</p>
<p>If running Butler Auth as a Node.js app on Linux, <a href="https://github.com/Unitech/pm2">PM2</a> and <a href="https://github.com/foreverjs/forever">Forever</a> are two good process monitors.</p>
<h3 id="monitoring-butler-auth">Monitoring Butler Auth</h3>
<p>Once Butler Auth is running it&rsquo;s a good idea to also monitor it. Otherwise you stand the risk of not getting notified if it for some reason misbehaves.</p>
<p>Butler Auth will log data on its memory usage to InfluxDB if</p>
<ol>
<li>The config file&rsquo;s <code>ButlerAuth.uptimeMonitor.enable</code> and <code>ButlerAuth.uptimeMonitor.storeInInfluxdb.enable</code> properties are both set to <code>true</code>.</li>
<li>The remaining InfluxDB properties of the config file are correctly configured.</li>
</ol>
<p>Assuming everything is correctly set up, you can then create a Grafana dashboard showing Butler Auth&rsquo;s memory use over time.<br>
You can also set up alerts in Grafana if so desired, with notifications going to most IM tools and email.</p>
<p>The following metrics are logged to InfluxDB, in a measurement called <code>butlerauth_memory_usage</code>:</p>
<ul>
<li>heap_used</li>
<li>heap_total</li>
<li>external</li>
<li>process_memory</li>
</ul>
<p>Each measurement is also tagged with a tag called <code>butlerauth_instance</code>. This tag is set in the main config file and is used in complex environments to separate between different Butler Auth instances.</p>
<p>A Grafana dashboard can look like this. Note that one of the available metrics (<code>external</code>) is not used in this particular dashboard. It&rsquo;s still logged to InfluxDB though.</p>
<p><img src="butler-memory-usage-grafana-1.png" alt="alt text" title="Butler memory usage in Grafana dashboard"></p>
<p>There is a <a href="https://github.com/ptarmiganlabs/butler/tree/master/docs/grafana">sample Grafana dashboard</a> in Butler&rsquo;s GitHub repo.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-7eee50e5d896d8c0f7761ed471a95d89">3 - Examples</h1>
    <div class="lead">Butler Auth in action!</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-aea2e29d74085012eefd7d988e5a3095">3.1 - Auth providers</h1>
    <div class="lead">Examples of how the authentication providers can be configured.</div>
	<h2 id="demo-web-page">Demo web page</h2>
<p>Butler Auth includes a small demo web site that makes it easy to try the various authentication providers (assuming you have accounts with them, of course).</p>
<p>The site is just a single page with links to each authentication provider supported by Butler Auth:</p>
<p><img src="butlerauth-auth-providers-demopage.png" alt="Demo UI for all authentication providers" title="Demo UI for all authentication providers"></p>
<p><strong>Note:</strong><br>
The demo site has hard coded links to a specific Qlik Sense Enterprise on Windows server.<br>
This means you can view the demo site above, but when clicking the links you won&rsquo;t be able to connect to the Sense server.</p>
<p>Instructions for customising the demo site are available <a href="/docs/examples/custom-demo-site">here</a>.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2dd318bb013393699bed09b10d39ec61">3.1.1 - Auth0</h1>
    <div class="lead">Configuring Auth0.</div>
	<p>Auth0 is an interesting authentication provider in that they offer both a user directory service, but also &ldquo;passthrough authentication&rdquo; to other auth providers such as Google, GitHub, Microsoft etc.</p>
<p>It&rsquo;s thus possible to set up Butler Auth to work with Auth0, and then via Auth0 get access to their entire list of supported auth providers.</p>
<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">auth0</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                              </span><span style="color:#8f5902;font-style:italic"># &#34;Auth0&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">issuerBaseURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN&gt;          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. mycompany.eu.auth0.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">baseURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># FQDN of Butler Auth, e.g. https://qliksenseauth.mycompany.com:8761&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>userIdShort</td>
<td>The provider will return the user&rsquo;s email address. If <code>userIdShort</code> is set to <code>true</code>, the @ character and email domain will be stripped from the email address returned by the provider. For example, &ldquo;<a href="mailto:joe@company.com">joe@company.com</a>&rdquo; would become just &ldquo;joe&rdquo;. true/false.</td>
</tr>
<tr>
<td>issuerBaseURL</td>
<td>The URL pointing to Auth0&rsquo;s service. You get this from Auth0. For Ptarmigan Labs (who&rsquo;s located in Europe/EU), the URL could be <code>ptarmiganlabs.eu.auth0.com</code>.</td>
</tr>
<tr>
<td>baseURL</td>
<td>URL to Butler Auth. For Ptarmigan Labs this could be <code>https://qliksenseauth.ptarmiganlabs.net:8761</code></td>
</tr>
<tr>
<td>clientId</td>
<td>Client ID from Auth0</td>
</tr>
<tr>
<td>clientSecret</td>
<td>Client secret from Auth0</td>
</tr>
</tbody>
</table>
<h2 id="auth0-configuration">Auth0 configuration</h2>
<p>These are the general steps to set up Auth0 for use with Butler Auth.</p>
<h3 id="create-application">Create application</h3>
<ol>
<li>
<p>Log in to your Auth0 dasboard (<a href="https://manage.auth0.com/dashboard">https://manage.auth0.com/dashboard</a>).</p>
</li>
<li>
<p>Go to the applications section, then create a new application. You can go through the step-by-step wizard, but it&rsquo;s usually easier to just fill in the needed fields on the Settings tab.
<img src="auth0-applications.png" alt="Auth0 applications" title="Auth0 applications"></p>
</li>
<li>
<p>Fill in the specifics of your application on the Settings tab. There are lots of fields here, the important ones are</p>
<ol>
<li><code>Name</code>: Application&rsquo;s name. &ldquo;Qlik Sense Enterprise&rdquo; or &ldquo;Butler Auth&rdquo; could be good names, but anything goes.</li>
<li><code>Description</code>: Not mandatory, but it&rsquo;s a good idea to write down a few words what the Auth0 does and its intended use cases.</li>
<li><code>Application Logo</code>: If you want your users to see a logo when authentication, this is where it&rsquo;s set.</li>
<li><code>Application Type</code>: Set to &ldquo;Regular Web Application&rdquo;.</li>
<li><code>Token Endpoint Authentication Method</code>: Set to &ldquo;Post&rdquo;.</li>
<li><code>Allowed Callback URLs</code>: This one is important from a security perspective. Set to the fully qualified domain name (FQDN) of Butler Auth, for example <code>https://qliksenseauth.ptarmiganlabs.net:8761/auth/auth0/redirect</code>. This is a list of URLs that Auth0 is authorized to call back to once the user has been successfully authenticated.</li>
<li>The rest of the fields on the Settings tab can be left at default values. But do review then anyway - your specific use case may require some additional settings to be set!
<img src="auth0-create-application.png" alt="Auth0 create application" title="Auth0 create application"><br>
<br></li>
</ol>
</li>
<li>
<p>Move on to the Connections tab. If you have previously set up &ldquo;connections&rdquo; (which is Auth0&rsquo;s word for other authentication providers), this is where you enable them.
<img src="auth0-create-application-connections.png" alt="Auth0 connections" title="Auth0 connections"></p>
</li>
</ol>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4c2d35dca41e25ad21157c2563d38f16">3.1.2 - Facebook</h1>
    <div class="lead">Using Facebook Login with Butler Auth</div>
	<p>Facebook offers authentication using OAuth 2.0.</p>
<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">facebook</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># &#34;Facebook&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>userIdShort</td>
<td>The provider will return the user&rsquo;s email address. If <code>userIdShort</code> is set to <code>true</code>, the @ character and email domain will be stripped from the email address returned by the provider. For example, &ldquo;<a href="mailto:joe@company.com">joe@company.com</a>&rdquo; would become just &ldquo;joe&rdquo;. true/false.</td>
</tr>
<tr>
<td>clientId</td>
<td>Client ID from Facebook</td>
</tr>
<tr>
<td>clientSecret</td>
<td>Client secret from Facebook</td>
</tr>
</tbody>
</table>
<h2 id="facebook-configuration">Facebook configuration</h2>
<p>General steps to set up Facebook Login for use with Butler Auth.</p>
<h3 id="create-application">Create application</h3>
<ol>
<li>
<p>Log in to Facebook&rsquo;s developer site <a href="https://developers.facebook.com">https://developers.facebook.com</a>.</p>
</li>
<li>
<p>Go to the <a href="https://developers.facebook.com/apps/">applications section</a>, then create a new application:<br>
&ldquo;Create App&rdquo; &gt; &ldquo;Build Connected Experiences&rdquo; &gt; Enter app name and contact email &gt; &ldquo;Create App&rdquo; &gt; &ldquo;Not a robot..&rdquo;.</p>
</li>
<li>
<p>Add the Facebook Login product to the newly created app:<br>
Click &ldquo;Set Up&rdquo; on the Facebook Login product &gt; &ldquo;Other&rdquo; as platform.</p>
</li>
<li>
<p>Open the basic settings:<br>
<img src="facebook-basic-settings.png" alt="Facebook basic settings" title="Facebook basic settings"></p>
<ol>
<li>Set a &ldquo;Display Name&rdquo;.</li>
<li>Enter a relevant &ldquo;Contact Email&rdquo; address.</li>
<li>Enter a link for your &ldquo;Privacy Policy URL&rdquo;.</li>
<li>Enter a link to your GDPR policy (or similar).</li>
<li>Upload an app icon. It will be shown to users when authenticating via Facebook.</li>
<li>Review remaining fields and fill in as needed for your specific use case.</li>
</ol>
</li>
<li>
<p>Copy the <code>App ID</code> and <code>App Secret</code> from the screen above to the Butler Auth config file.</p>
</li>
</ol>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-7abe6c4ab3df159c91026f5614d0e056">3.1.3 - Google</h1>
    <div class="lead">Using Google credentials with Butler Auth.</div>
	<p>Google offers authentication using OAuth 2.0.</p>
<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">google</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                             </span><span style="color:#8f5902;font-style:italic"># &#34;Google&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>userIdShort</td>
<td>The provider will return the user&rsquo;s email address. If <code>userIdShort</code> is set to <code>true</code>, the @ character and email domain will be stripped from the email address returned by the provider. For example, &ldquo;<a href="mailto:joe@company.com">joe@company.com</a>&rdquo; would become just &ldquo;joe&rdquo;. true/false.</td>
</tr>
<tr>
<td>clientId</td>
<td>Client ID from Google</td>
</tr>
<tr>
<td>clientSecret</td>
<td>Client secret from Google</td>
</tr>
</tbody>
</table>
<h2 id="google-configuration">Google configuration</h2>
<p>General steps to set up Google for use with Butler Auth.</p>
<h3 id="create-application">Create application</h3>
<ol>
<li>Log in to <a href="https://console.developers.google.com">Google Cloud</a>. The <a href="https://console.cloud.google.com/home/dashboard">dashboard</a> provides a good overview of your Google cloud assets.</li>
<li>Go to the &ldquo;Credentials&rdquo; section (<a href="https://console.developers.google.com/apis/credentials">https://console.developers.google.com/apis/credentials</a>) of the <a href="https://console.developers.google.com/apis/dashboard">API &amp; Services</a> page. Make sure to select the correct project in the drop-down at the top of the page.</li>
<li>Create a new client ID:
<ol>
<li>&ldquo;CREATE CREDENTIALS&rdquo; (button at top) &gt; &ldquo;OAuth client ID&rdquo; &gt; Application typ &ldquo;Web application&rdquo;</li>
<li>Enter desired name in the &ldquo;Name&rdquo; field.</li>
<li>Add valid callback URIs. The one responsible for Butler Auth is <code>https://&lt;FQDN of Butler Auth&gt;:&lt;Butler Auth REST port&gt;/oauth2callback</code>. Note that Butler Auth&rsquo;s REST API port can be changed in the main config file of Butler Auth. At least one URI is required.<br>
Click &ldquo;Create&rdquo;.</li>
<li>Take note of the client ID and secret. Copy them to the corresponding fields in Buther Auth&rsquo;s config file.</li>
</ol>
</li>
<li>Set up an <a href="https://console.developers.google.com/apis/credentials/consent">OAuth consent screen</a> that will be shown to users when they authenticate to Qlik Sense using their Google credentials.</li>
</ol>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cd03653be383928caf55ca08e6e255f9">3.1.4 - Keycloak</h1>
    <div class="lead">Using Keycloak with Butler Auth.</div>
	<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">keycloak</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># &#34;Keycloak&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN of Keycloak server&gt;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">realm</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># E.g. ptarmiganlabs</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">authorizationURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/auth</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">tokenURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/token</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userInfoURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/userinfo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>userIdShort</td>
<td>The provider will return the user&rsquo;s email address. If <code>userIdShort</code> is set to <code>true</code>, the @ character and email domain will be stripped from the email address returned by the provider. For example, &ldquo;<a href="mailto:joe@company.com">joe@company.com</a>&rdquo; would become just &ldquo;joe&rdquo;. true/false.</td>
</tr>
<tr>
<td>clientId</td>
<td>Client ID from Keycloak&rsquo;s <code>*realm*</code> &gt; <code>Clients</code> &gt; <code>*client*</code> &gt; <code>Settings</code> page.</td>
</tr>
<tr>
<td>clientSecret</td>
<td>Client secret from Keycloak&rsquo;s <code>*realm*</code> &gt; <code>Clients</code> &gt; <code>*client*</code> &gt; <code>Credentials</code> page.</td>
</tr>
<tr>
<td>host</td>
<td>Full URL to Keycloak</td>
</tr>
<tr>
<td>realm</td>
<td>Keycloak realm to use.</td>
</tr>
<tr>
<td>authorizationURL</td>
<td>See below for instruction on how to get this.</td>
</tr>
<tr>
<td>tokenURL</td>
<td>See below for instruction on how to get this.</td>
</tr>
<tr>
<td>userInfoURL</td>
<td>See below for instruction on how to get this.</td>
</tr>
</tbody>
</table>
<h2 id="keycloak-configuration">Keycloak configuration</h2>
<p>General steps to set up Keycloak for use with Butler Auth.</p>
<p>In the examples below Keycloak is available at <code>http://qliksenseauth.ptarmiganlabs.net:8082</code>.<br>
This works for demonstration purposes, but in a production scenario https should be used.</p>
<ol>
<li>
<p>Log in to the Keycloak admin console.
<img src="keycloak.png" alt="Keycloak" title="Keycloak"></p>
</li>
<li>
<p>If you don&rsquo;t already have a Keycloak <em>realm</em>, create one via the menu in the upper left corner.
<img src="keycloak-addrealm-1.png" alt="Keycloak add realm" title="Keycloak add realm"></p>
</li>
<li>
<p>Fill in the realm settings. The screen shots below only gives some guidance, you are <em><strong>STRONGLY</strong></em> encouraged to review all settings. The <code>Frontend URL</code> is the URL where Butler Auth will call Keycloak.
<img src="keycloak-general-1.png" alt="Keycloak realm general" title="Keycloak realm general"></p>
</li>
<li>
<p>Open the <code>Clients</code> menu on the left. Add a new one.
<img src="keycloak-clients-add-1.png" alt="Keycloak clients add" title="Keycloak clients add"></p>
</li>
<li>
<p>Fill in the details of the new client.
<img src="keycloak-client-config-1.png" alt="Keycloak client 1" title="Keycloak client 1"></p>
<p>&hellip; and lower part of that page&hellip;<br>
The <code>Valid Redirect URIs</code> is a list of approved/allowed sources. Only calls originating from these URIs will be handled by this Keycloak realm/client.<br>
In our case, this is the callback URL of Butler Auth.
<img src="keycloak-client-config-2.png" alt="Keycloak client 2" title="Keycloak client 2"></p>
</li>
<li>
<p>The <code>Credentials</code> tab contains the Client secret that should be copied to Butler Auth.
<img src="keycloak-client-config-credentials-1.png" alt="Keycloak client credentials" title="Keycloak client credentials"></p>
</li>
<li>
<p>The settings on the remaining tabs of the client configuration are used to fine-tune the authentication setup. The default values should work as a starting point though.</p>
</li>
<li>
<p>If you don&rsquo;t already have any users in Keycloak it&rsquo;s easy to set up one for testing purposes.
Open the <code>Users</code> menu on the left. Click the <code>Add user</code> button in upper right corner.
<img src="keycloak-users-1.png" alt="Keycloak users" title="Keycloak users"></p>
<p><img src="keycloak-users-add-1.png" alt="Keycloak users add" title="Keycloak users add"></p>
</li>
</ol>
<h3 id="keycloak-identity-brokering">Keycloak Identity Brokering</h3>
<p>Keycloak has a cool feature similar to the one offered by <a href="/docs/examples/auth-providers/auth0">Auth0</a>, where you can use another, 3rd party identity provider for the actual authentication work.</p>
<p>For example, you can set up Butler Auth to use Keycloak (and have all the benefits offered by Keycloak), and then have Keycloak forward the authentication requqests to IdPs such as Microsoft, Google, Facebook, LinkedIn, Twitter, GitHub and others.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8a04f02a952619a29f42052277d25a99">3.1.5 - LDAP</h1>
    <div class="lead">LDAP can be used both as a source for user directory data, but also to authenticate users.</div>
	<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">ldap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                               </span><span style="color:#8f5902;font-style:italic"># &#34;LDAP&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://&lt;FQDN&gt;:8081       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># URL where login UI for this provider is available</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">ldapServer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># Information about the LDAP server to authenticate against</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;ldap(s)://ldap.mydomain.com&gt;   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Both normal (ldap://) and secure (ldaps://) LDAP is supported</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">636</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># Usually 389 for LDAP and 636 for LDAPS</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">bindUser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;domain\username&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># Service account used to log into the LDAP server</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">bindPwd</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;password&gt;        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Password of service account</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">searchBase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;dc=...,dc=...,dc=...&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Base path from which authentication attempts will start</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">searchFilter</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;(&amp;(objectcategory=person)(objectclass=user)(|(samaccountname={{username}})(mail={{username}})))&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Filter used to get info about users in LDAP server</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Settings here will override default TLS behaviour. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Useful for example if your cert is for another domain wrt the host name of the LDAP server.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># If a setting is empty it will simply be ignored by Butler Auth.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Necessary if the LDAP server isusing a self-signed certificate</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Should point to a PEM coded CA certificate file.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">ca</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>url</td>
<td>Tells Butler Auth where it should send the user when it&rsquo;s time to enter his/her username and password. A basic web page for entering LDAP credentials is included in Butler Auth, but for production scenarios you probably want to create your own login page.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>host</td>
<td>Host where LDAP server is running. <code>ldap://ldap.mydomain.com</code> is insecure/not encryptet, <code>ldaps://ldap.mydomain.com</code> is secure. Use ldaps if possible.</td>
</tr>
<tr>
<td>port</td>
<td>Port to use on LDAP server. Usually 636 for ldaps, 389 for ldap.</td>
</tr>
<tr>
<td>bindUser</td>
<td>User to log in with on LDAP server. Usually a service account of some kind.</td>
</tr>
<tr>
<td>bindPwd</td>
<td>Password for bindUser.</td>
</tr>
<tr>
<td>searchBase</td>
<td>The base path from which authentication attempts will be done. For an Active Directory domain called <code>sales</code> at company <code>mycompany.com</code> it could be <code>dc=sales,dc=mycompany,dc=com'</code></td>
</tr>
<tr>
<td>searchFilter</td>
<td>Filter used to determine if a user exists in the LDAP server. The example above should be a good starting point for standard-install Active Directory servers.</td>
</tr>
<tr>
<td>ca</td>
<td>If ldaps is used and the LDAP server is configured with proper certificates that use publicly recognizable certificate authorities, this <code>ca</code> section is not needed. If self-signed certificates are used you need to specify the CA certificate here for ldaps to work.</td>
</tr>
</tbody>
</table>
<h3 id="using-butler-auths-built-in-login-page">Using Butler Auth&rsquo;s built-in login page</h3>
<p>If you want to use the built-in login page to begin with, it&rsquo;s configured like this:</p>
<ol>
<li>Let&rsquo;s assume Butler Auth is hosted at <code>https://butlerauth.company.com</code>, with the http server set up to listen on port 8081.<br>
The demo web UI showing all the authentication providers is then available at <code>https://butlerauth.company.com:8081/auth-providers.html</code>.</li>
<li>In order to use the demo login page you should set the <code>ButlerAuth.authProvider.ldap.url</code> to <code>https://butlerauth.company.com:8081</code></li>
</ol>
<p>Here is the built-in LDAP login page:</p>
<p><img src="butlerauth-ldap-loginpage.png" alt="LDAP demo login page" title="LDAP demo login page"></p>
<h2 id="ldap-configuration">LDAP configuration</h2>
<p>Configuring the directory server (which Butler Auth talks to using the LDAP protocol) is beyond the scope of this site.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c22ea6d7a86b36cf6053b0b37a8544b7">3.1.6 - Local file</h1>
    <div class="lead">Use a local file as your user directory.</div>
	<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">localFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># &#34;Local file&#34; provider reads user data from a file on disk</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                    
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://&lt;FQDN&gt;:8081       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># URL where login UI for this provider is available</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">./config/users.yaml  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># YAML file containing usernames and passwords</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>url</td>
<td>Tells Butler Auth where it should send the user when it&rsquo;s time to enter his/her username and password. A basic web page for entering local-file credentials is included in Butler Auth, but for production scenarios you probably want to create your own login page.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>userFile</td>
<td>A YAML file containing usernames and passwords.</td>
</tr>
</tbody>
</table>
<h3 id="using-butler-auths-built-in-login-page">Using Butler Auth&rsquo;s built-in login page</h3>
<p>If you want to use the built-in login page to begin with, it&rsquo;s configured like this:</p>
<ol>
<li>Let&rsquo;s assume Butler Auth is hosted at <code>https://butlerauth.company.com</code>, with the http server set up to listen on port 8081.<br>
The demo web UI showing all the authentication providers is then available at <code>https://butlerauth.company.com:8081/auth-providers.html</code>.</li>
<li>In order to use the demo login page you should set the <code>ButlerAuth.authProvider.localFile.url</code> to <code>https://butlerauth.company.com:8081</code></li>
</ol>
<p>Here is the built-in local file login page:</p>
<p><img src="butlerauth-localfile-loginpage.png" alt="Local file demo login page" title="Local file demo login page"></p>
<h2 id="userfile-format">Userfile format</h2>
<p>The file containing user credentials is YAML-formatted:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">users</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">anna</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">fullName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Anna Svenson</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aaa</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Root admin user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">joe</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">fullName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Joe Jonson</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">bbb</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">comment</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Regular user</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div>

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Remember!</h4>

    <p>Make sure to secure this file properly.</p>
<p>Anyone with access to this file can log into Qlik Sense as any of the users in the file.</p>


</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2a7aed702615aac0c9d28e8768cc73ce">3.1.7 - Microsoft</h1>
    <div class="lead">Using Microsoft credentials with Butler Auth.</div>
	<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">microsoft</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># &#34;Microsoft&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>userIdShort</td>
<td>The provider will return the user&rsquo;s email address. If <code>userIdShort</code> is set to <code>true</code>, the @ character and email domain will be stripped from the email address returned by the provider. For example, &ldquo;<a href="mailto:joe@company.com">joe@company.com</a>&rdquo; would become just &ldquo;joe&rdquo;. true/false.</td>
</tr>
<tr>
<td>clientId</td>
<td>Client ID from Microsoft</td>
</tr>
<tr>
<td>clientSecret</td>
<td>Client secret from Microsoft</td>
</tr>
</tbody>
</table>
<h2 id="microsoft-configuration">Microsoft configuration</h2>
<p>These are the general steps to set up Microsoft for use with Butler Auth.</p>
<ol>
<li>
<p>Log in to the <a href="https://portal.azure.com">Miceosoft Azure portal</a>.</p>
</li>
<li>
<p>Go to the <a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">App registrations</a> page.</p>
</li>
<li>
<p>The screen shots below show a minimum configuration - you should review all fields to make sure the configuration is correct for your specific use case.</p>
<p>On the <em>application overview</em> tab you find the Client ID, among other things.
<img src="microsoft-application-1.png" alt="Microsoft application overview" title="Microsoft application overview"></p>
<p>On the <em>Branding tab</em> you can upload an image that&rsquo;s shown when users authenticate.
<img src="microsoft-application-branding-1.png" alt="Microsoft application branding" title="Microsoft application ovewview"></p>
<p>On the <em>Authentication tab</em> you set the Redirect URIs. This is the URL where Butler Auth is running, appended with &ldquo;/auth/microsoft/redirect&rdquo;.
<img src="microsoft-application-authentication-1.png" alt="Microsoft application authentication" title="Microsoft application authentication"></p>
<p>On the <em>Secrets tab</em> you find the Client secret that should be copied to the Butler Auth config file.
<img src="microsoft-application-secrets-1.png" alt="Microsoft application secrets" title="Microsoft application secrets"></p>
</li>
</ol>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1c49dcbb2c8ad8f0fff0647b2a5f82ab">3.1.8 - Okta</h1>
    <div class="lead">Using Okta with Butler Auth.</div>
	<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">okta</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                               </span><span style="color:#8f5902;font-style:italic"># &#34;Okta&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">oktaDomain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Okta domain from Google admin console&gt; </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.q. https://myid-123456.okta.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">idp</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>userIdShort</td>
<td>The provider will return the user&rsquo;s email address. If <code>userIdShort</code> is set to <code>true</code>, the @ character and email domain will be stripped from the email address returned by the provider. For example, &ldquo;<a href="mailto:joe@company.com">joe@company.com</a>&rdquo; would become just &ldquo;joe&rdquo;. true/false.</td>
</tr>
<tr>
<td>clientId</td>
<td>Client ID from Okta</td>
</tr>
<tr>
<td>clientSecret</td>
<td>Client secret from Okta</td>
</tr>
<tr>
<td>oktaDomain</td>
<td>The URL you get from Okta. Usually something like &ldquo;sometext.okta.com</td>
</tr>
<tr>
<td>idp</td>
<td>Can usually be left blank.</td>
</tr>
</tbody>
</table>
<h2 id="okta-configuration">Okta configuration</h2>
<p>These are the general steps to set up Okta for use with Butler Auth.<br>
In the screen shots below Okta&rsquo;s free tier is used - things might look different for you.</p>
<ol>
<li>
<p>Sign into <a href="https://www.okta.com/">Okta</a>. Go to the <code>Applications</code> tab:
<img src="okta-apps-1.png" alt="Okta applications" title="Okta applications"></p>
</li>
<li>
<p>Create a new &ldquo;Web&rdquo; application and give it a good name:
<img src="okta-app-new-web-1.png" alt="Okta new web app" title="Okta new web app"></p>
<p>Fill in <code>Name</code>, <code>Base URIs</code> (which is the Butler Auth URL) and <code>Login redirect URIs</code> (which is Butler Auth&rsquo;s Okta  callback URL). Review the other fields to make sure they match your use case. Click <code>Done</code>.
<img src="okta-app-new-1.png" alt="Okta new web app" title="Okta new web app"></p>
</li>
<li>
<p>Add users as needed.
<img src="okta-users-1.png" alt="Okta users" title="Okta users"></p>
</li>
</ol>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-790dc315439d08eab01dc0331a2ed8b4">3.1.9 - Single user</h1>
    
	<h2 id="butler-auth-configuration">Butler Auth configuration</h2>
<p>The settings in the config file are:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">singleUser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># &#34;Single user&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">userId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">goran                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># A user that already exists in Qlik Sense. All access to Sense will be done using this user.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>Enable or disable this authentication provider. true/false.</td>
</tr>
<tr>
<td>userDirectory</td>
<td>The Qlik Sense Enterprise user directory that will be used once the user has been authenticated by the authentication provider.</td>
</tr>
<tr>
<td>userId</td>
<td>Qlik Sense user ID that all logins will use.</td>
</tr>
</tbody>
</table>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e8beb0e1c0074106175db3fa07ba78a9">3.2 - Customizing the demo site</h1>
    <div class="lead">Adapt the built-in web site to work with your own Sense server.</div>
	<h2 id="butler-auth-demo-site">Butler Auth demo site</h2>
<p>A single web page provides an easy way to try out the different auth providers:</p>
<p><img src="butlerauth-auth-providers-demopage.png" alt="Demo UI for all authentication providers" title="Demo UI for all authentication providers"></p>
<h2 id="the-demo-site---how-does-it-work">The demo site - how does it work?</h2>
<p>Each auth provider included on the demo site has a link that takes the user to Qlik Sense.
For example, clicking the Google icon the user will be sent to <code>https://senseprod.ptarmiganlabs.net/ba-google</code>.</p>
<p>senseprod.ptarmiganlabs.net is a Qlik Sense Enterprise on Windows server, with a virtual proxy called <code>ba-google</code> (hint: ba=butlerauth).</p>
<p>That virtual proxy has the usual settings plus a link to a &ldquo;authentication module&rdquo; that should be used.</p>
<p><img src="butlerauth-virtualproxy-google.png" alt="Virtual proxy using Butler Auth for Google authentication" title="Virtual proxy using Butler Auth for Google authentication"></p>
<p>The authentication module is - surprise - part of Butler Auth. More specifically the REST API of Butler Auth has an endpoint named <code>/auth/google</code>.<br>
With Butler Auth&rsquo;s REST API being hosted at <code>https://qliksenseauth.ptarmiganlabs.net:8761</code> (this is all set in the main config file), the full URL for the virtual proxy&rsquo;s authentication module is <code>https://qliksenseauth.ptarmiganlabs.net:8761/auth/google</code>.</p>
<h2 id="customizing-the-demo-site">Customizing the demo site</h2>
<p>The list below should be a good starting point if you want to customize the demo site to your own server/network/Qlik Sense environment.</p>
<h3 id="configure-http-server">Configure http server</h3>
<p>Butler Auth&rsquo;s build in web server is always enabled, but must be configured.<br>
Given the config below the web server will be running at <code>https://qliksenseauth.ptarmiganlabs.net:8081</code>.</p>
<p>https is enabled using the specified certificate/key. In this case the certificate is not password protected (the password field is empty).</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">ButlerAuth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">server</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">web</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># The web/http server used to serve the sample login pages included in Butler Auth</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">qliksenseauth.ptarmiganlabs.net  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Hostname of the http server. Would be container name when running under Docker. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8081</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># Port where the http server will listen</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Used to secure the http server with TLS. I.e. https.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">cert</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/cert/cert.cer</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/cert.key</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span></code></pre></div><h3 id="create-qlik-sense-virtual-proxies">Create Qlik Sense virtual proxies</h3>
<p>You can have many virtual proxies in Qlik Sense, even if you have just a single Sense server.<br>
Each virtual proxy implements exactly one authentication method, or uses anonymous access to Sense.</p>
<p>If you want to try all the auth providers offered by Butler Auth, you need to create one virtual proxy for each provider:</p>
<p><img src="qliksense-virtualproxies.png" alt="Qlik Sense virtual proxies used together with Butler Auth" title="Qlik Sense virtual proxies used together with Butler Auth"></p>
<p>An example of a virtual proxy configuration for Google authentication is found up above on this page.</p>
<h3 id="modify-demo-site">Modify demo site</h3>
<p>The demo site is included in the GitHub repository and in the image on Docker Hub. It&rsquo;s located at <code>/src/html</code> in the GitHub repository.</p>
<p>The html pages are reasonably basic, but a general understanding of html, css and Javascript is needed to understand how they work.</p>
<p>The pages only use paths relative to the http server&rsquo;s base URL, meaning that the pages <em>should</em> work in your Sense environment without any changes. You might want to change look-and-feel etc though - feel free to use the provided pages as inspiration!</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a14d5cf4b74e46d59695f3d4a0c959e4">3.3 - Butler Auth is observable</h1>
    <div class="lead">Monitoring Butler Auth, making sure it&rsquo;s alive and well.</div>
	<h2 id="heartbeats">Heartbeats</h2>
<p>Butler Auth has an optional heartbeat feature, which when enabled will call a specific URL with a configurable interval.</p>
<p>A typical scenario is to use a monitoring tool such as <a href="https://healthchecks.io/">Healthchecks.io</a> to ensure that the heartbeats arrive on schedule.<br>
That tool can then alert if the heartbeats don&rsquo;t arrive on time.<br>
Healthchecks.io is available both as a Docker image for self-hosting and as a SaaS offering.</p>
<p>Configuration of heartbeats is described <a href="/docs/getting-started/setup/config-file/config-file-sections/20-heartbeat/">here</a>.</p>
<p>Here is a self-hosted Heahlthcheck.io instance used to monitor the Butler family of tools:
<img src="healtchecksio-senseops-1.png" alt="Healthchecks.io" title="Healthchecks.io"></p>
<h2 id="uptime-monitor-with-metrics-in-influxdb">Uptime monitor with metrics in InfluxDB</h2>
<p>Another aspect of monitoring is to keep track of the internals of the service in question.</p>
<p>Butler Auth&rsquo;s &ldquo;uptime monitor&rdquo; is an optional feature that can be <a href="/docs/getting-started/setup/config-file/config-file-sections/40-uptime-monitor/">enabled in the config file</a>.</p>
<p>When enabled it will send metrics on how much memory Butler Auth uses to an InfluxDB database, as well as logging these metrics to the log files.<br>
Logging to InfluxDB and log files can be individually enabled/disabled.<br>
Once the metrics are in InfluxDB then can be viewed using Grafana:</p>
<p><img src="butlerauth-uptimemonitor-grafana-1.png" alt="Butler Auth memory usage visualized using Grafana" title="Butler Auth memory usage visualized using Grafana"></p>
<h2 id="docker-healthcheck">Docker healthcheck</h2>
<p>The main config file has <a href="/docs/getting-started/setup/config-file/config-file-sections/30-docker-healtcheck/">options for enabling Docker healthchecks</a>.<br>
If running Butler Auth in Kubernetes this feature can useful when setting up custom avaialability logic for K8s containers.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b00a88a07ceb21b1a83e5822e0c86c1d">4 - Reference</h1>
    <div class="lead">Reference material for Butler Auth.</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-7f7d6f8507fae88d284446932d7bce54">4.1 - Config file</h1>
    <div class="lead">Description of Butler Auth&rsquo;s config file.</div>
	<h2 id="main-config-file">Main config file</h2>
<p>The <code>production_template.yaml</code> config file looks like this:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">ButlerAuth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Logging configuration</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">logLevel</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">info     </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Log level. Possible log levels are silly, debug, verbose, info, warn, error</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">fileLogging</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># true/false to enable/disable logging to disk file</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">logDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Subdirectory where log files are stored. Absolute or relative path accepted.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Heartbeats can be used to send &#34;I&#39;m alive&#34; messages to any other tool, e.g. a infrastructure monitoring tool</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># The concept is simple: The remoteURL will be called at the specified frequency. The receiving tool will then know </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># that Butler Auth is alive.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">heartbeat</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">remoteURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://my.monitoring.server/some/path/</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">frequency</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">60000</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># Milliseconds</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Docker health checks are used when running Butler Auth as a Docker container. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># The Docker engine will call the container&#39;s health check REST endpoint with a set interval to determine</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># whether the container is alive/well or not.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># If you are not running Butler Auth in Docker you can safely disable this feature. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dockerHealthCheck</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Control whether a REST endpoint will be set up to serve Docker health check messages</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">12398</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#8f5902;font-style:italic"># Port the Docker health check service runs on (if enabled)</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Uptime monitor</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">uptimeMonitor</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Should uptime messages be written to the console and log files?</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">frequency</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">300000</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#8f5902;font-style:italic"># Milliseconds</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">logLevel</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">info                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Starting at what log level should uptime messages be shown?</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">storeInInfluxdb</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">hostIP</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;IP or host name&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">hostPort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8086</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">auth</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">user_joe</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">joesecret</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">dbName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">butlerauth</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">instanceTag</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">DEV             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Tag that can be used to differentiate data from multiple Butler instances</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Default retention policy that should be created in InfluxDB when Butler creates a new database there. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># Any data older than retention policy threshold will be purged from InfluxDB.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">retentionPolicy</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10d</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">duration</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10d</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Server and https settings</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">server</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">rest</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                       </span><span style="color:#8f5902;font-style:italic"># The REST server is the authentication server called by Qlik Sense.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN&gt;           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Hostname of the REST server. Would be container name when running under Docker, otherwise something like qliksenseauth.mydomain.com.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8761</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># Port where the REST server will listen</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">rateLimit</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># Used to limit number of authentication requests during a given time window. Used to prevent brute forcing attacks.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># Enable/disable rate limiting for this REST API. true/false.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">windowSize</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">60000</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#8f5902;font-style:italic"># How long (milliseconds) is the time window we&#39;re capping # of logins for? Default 5 min if not specified.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">maxCalls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># Max # of logins from Qlik Sense during time window above. Default 100 if not specified.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Many 3rd party auth providers require the OAuth 2 server to use https. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># Enable/disable https. While always recommended, https is strictly not needed for local file authentication, for example.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">cert</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/certfile.cer   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># TLS certificate file </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/certfile.key    </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># TLS key file</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#8f5902;font-style:italic"># Passphrase for TLS key file, if used</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">web</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                        </span><span style="color:#8f5902;font-style:italic"># The web/http server used to serve the sample login pages included in Butler Auth</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN&gt;           </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># FQDN of the http server </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8081</span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#8f5902;font-style:italic"># Port where the http server will listen</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Used to secure the http server with TLS. I.e. https.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">cert</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/certfile.cer</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">key</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/certfile.key</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Auth providers are responsible for authenticating users before they are forwarded to Qlik Sense Enterprise.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">authProvider</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">localFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># &#34;Local file&#34; provider reads user data from a file on disk</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">                    
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://&lt;FQDN&gt;:8081       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># URL where login UI for this provider is available</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">./config/users.yaml  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># YAML file containing usernames and passwords</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">ldap</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                               </span><span style="color:#8f5902;font-style:italic"># &#34;LDAP&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://&lt;FQDN&gt;:8081       </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># URL where login UI for this provider is available</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">ldapServer</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                     </span><span style="color:#8f5902;font-style:italic"># Information about the LDAP server to authenticate against</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;ldap(s)://ldap.mydomain.com&gt;   </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Both normal (ldap://) and secure (ldaps://) LDAP is supported</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">636</span><span style="color:#f8f8f8;text-decoration:underline">                   </span><span style="color:#8f5902;font-style:italic"># Usually 389 for LDAP and 636 for LDAPS</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">bindUser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;domain\username&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#8f5902;font-style:italic"># Service account used to log into the LDAP server</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">bindPwd</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;password&gt;        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Password of service account</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">searchBase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;dc=...,dc=...,dc=...&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Base path from which authentication attempts will start</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">searchFilter</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;(&amp;(objectcategory=person)(objectclass=user)(|(samaccountname={{username}})(mail={{username}})))&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Filter used to get info about users in LDAP server</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Settings here will override default TLS behaviour. </span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Useful for example if your cert is for another domain wrt the host name of the LDAP server.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># If a setting is empty it will simply be ignored by Butler Auth.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Necessary if the LDAP server isusing a self-signed certificate</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#8f5902;font-style:italic"># Should point to a PEM coded CA certificate file.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">                    </span><span style="color:#204a87;font-weight:bold">ca</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">singleUser</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                         </span><span style="color:#8f5902;font-style:italic"># &#34;Single user&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">goran                  </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># A user that already exists in Qlik Sense. All access to Sense will be done using this user.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">google</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                             </span><span style="color:#8f5902;font-style:italic"># &#34;Google&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">facebook</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># &#34;Facebook&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">microsoft</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># &#34;Microsoft&#34; OAuth2 provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">okta</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                               </span><span style="color:#8f5902;font-style:italic"># &#34;Okta&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">oktaDomain</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Okta domain from Google admin console&gt; </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.q. https://myid-123456.okta.com&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">idp</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">keycloak</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                           </span><span style="color:#8f5902;font-style:italic"># &#34;Keycloak&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN of Keycloak server&gt;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">realm</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                          </span><span style="color:#8f5902;font-style:italic"># E.g. ptarmiganlabs</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">authorizationURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;        </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/auth</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">tokenURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;                </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/token</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userInfoURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. https://keycloak.mydomain.com/auth/realms/&lt;myrealm&gt;/protocol/openid-connect/userinfo</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">auth0</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">                              </span><span style="color:#8f5902;font-style:italic"># &#34;Auth0&#34; provider</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">enable</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userDirectory</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">lab             </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Qlik Sense user directory that will be used for the authenticated user</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">userIdShort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">               </span><span style="color:#8f5902;font-style:italic"># If true, the email domain will be removed. I.e. &#34;joe.smith@domain.com&#34; will be changed to &#34;joe.smith&#34;.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">issuerBaseURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;FQDN&gt;          </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># E.g. mycompany.eu.auth0.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">baseURL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;URL&gt;                 </span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># FQDN of Butler Auth, e.g. https://qliksenseauth.mycompany.com:8761&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientId</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client ID&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientSecret</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;Client secret&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Settings relating to Qlik Sense</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">qlikSense</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># Certificates to use when calling Sense APIs. Get these from the Certificate Export in QMC.</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">certFile</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># If running under Docker, use these paths:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># clientCert: /nodeapp/config/certificate/client.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># clientCertKey: /nodeapp/config/certificate/client_key.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># clientCertCA: /nodeapp/config/certificate/root.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#8f5902;font-style:italic"># If running as a native Node.js app, point to where the cert files are stored:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientCert</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/client.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientCertKey</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/client_key.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientCertCA</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/path/to/root.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:bold">clientCertPassphrase</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> 
</span></code></pre></div><h3 id="comments">Comments</h3>
<ul>
<li>
<p>The default location for cert/key exports is (assuming a standard install of Qlik Sense) <code>C:\ProgramData\Qlik\Sense\Repository\Exported Certificates\&lt;name specified during certificate export&gt;</code></p>
<p>The files needed by Butler Auth are <code>client.pem</code>, <code>client_key.pem</code> and <code>root.pem</code>.</p>
</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bf5246697dc6c6906cb82b681e3668c9">4.2 - Passport.js</h1>
    <div class="lead">Butler Auth uses Passport.js for most authentication providers.</div>
	<h2 id="passportjs">Passport.js</h2>
<p><a href="http://www.passportjs.org/">Passport.js</a> is an open source library focusing on authentication.</p>
<p>From their own site:</p>


<div class="pageinfo pageinfo-primary">
<p>Passport is authentication middleware for Node.js. Extremely flexible and modular, Passport can be unobtrusively dropped in to any Express-based web application. A comprehensive set of strategies support authentication using a username and password, Facebook, Twitter, and more.</p>

</div>

<p>Butler Auth uses Passport.js for many (but not all) authentication strategies.</p>
<p>Given that Passport.js uses a consistent interface for all authentication strategies it&rsquo;s usually quite easy to add additional authentication providers to Butler Auth.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0cd03205810ca559667d498c383386e0">4.3 - Images &amp; artwork attribution</h1>
    <div class="lead">Shoutout to these great creators for their excellent images and artwork!</div>
	<h2 id="images">Images</h2>







<div class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 610px">
	<img class="card-img-top" src="/docs/reference/images-artwork/background_huc3fc0b9e8ea2f7a32647708c734aaa55_39477132_600x400_resize_catmullrom_2.png" width="600" height="400">
	
	<div class="card-body px-0 pt-2 pb-0">
		<p class="card-text">
Cover page
</p>
	</div>
	
</div>
<p>Original by <a href="https://unsplash.com/@thejmoore?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Jon Moore</a> on <a href="https://unsplash.com/s/photos/padlock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a>.<br>
Some editing done before using it on this site.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0e10aa79b66ebaf60284768f9c0d59cf">5 - Security considerations</h1>
    <div class="lead">Security is important! Keep these things in mind when deploying Butler Auth.</div>
	

<div class="pageinfo pageinfo-primary">
<p>Security is a whole field in its ownn.<br>
What&rsquo;s considered secure in one company might be considered insecure in another.</p>
<p>It&rsquo;s a good idea to review your tools and services every now and then, for example making sure they are updated to include the latest secutity patches etc.</p>
<p>When in doubt, be paranoid.</p>

</div>

<h2 id="security-considerations">Security considerations</h2>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Security/Disclosure</h4>

    If you discover a serious bug with Butler Auth that may pose a security problem, please disclose it confidentially to <a href="mailto:security@ptarmiganlabs.com">security@ptarmiganlabs.com</a> first, so that it can be assessed and hopefully fixed prior to being exploited. Please do not raise GitHub issues for security-related doubts or problems.

</div>

<ul>
<li>
<p>Configure the firewall on the server where Buter Auth is running to only accept connections from IPs that matter. While convenient and tempting to leave servers open with respect to network traffic, it&rsquo;s usually a very bad idea. Reduce the attack vectors whenever possible.</p>
</li>
<li>
<p>Butler Auth uses various Node.js modules from <a href="https://www.npmjs.com/">npm</a>. If concerned about security, you should review these dependencies and decide whether there are issues in them or not.</p>
</li>
<li>
<p>Same thing with Butler Auth itself - while efforts have been made to make it secure, you need to decide for yourself whether the level of security is enough for your use case.</p>
<p>Butler is continuously checked for security vulnerabilities by using GitHub security audit, <a href="https://snyk.io/">Snyk</a>, npm audit and other tools.</p>
<p>That said, all software - including Butler Auth - has bugs and security issues.</p>
</li>
<li>
<p>Once again: <em><strong>YOU</strong></em> are responsible for determining if Butler Auth meets <em><strong>YOUR</strong></em> security requirements. The legal text is found in the <a href="/docs/legal-stuff/">MIT license</a>.</p>
</li>
</ul>
<h2 id="butler-auth-talking-to-qlik-sense">Butler Auth talking to Qlik Sense</h2>
<p>Butler Auth uses https for all communication with Sense, using Sense&rsquo;s certificates for authentication.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-77e780299a8751a6c2387c723d1abb0b">6 - Legal stuff</h1>
    <div class="lead">Information om licenses, personal integrity and more.</div>
	<h2 id="license">License</h2>
<p>Butler is distributed under the <a href="https://en.wikipedia.org/wiki/MIT_License">MIT license</a>.</p>
<pre><code>MIT License

Copyright (c) 2020-2021 Göran Sander

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</code></pre><h2 id="data-collection">Data collection</h2>
<p>This documentation site was built using <a href="https://gohugo.io/">Hugo</a> and consists of static web pages hosted on <a href="https://pages.github.com/">GitHub Pages</a>.</p>
<p>GitHub probably keep log files for GitHub Pages, your visit to this documentation site is thus likely to be recorded there.</p>
<h2 id="google-analytics">Google Analytics</h2>
<p>Google Analytics is used to track general site usage.</p>
<p>Aggregated Google Analytics data may be used to determine, and in some cases publicly communicate, how popular the site is.<br>
Examples of aggregated metrics are how many users have visited the site, from where in the world they accessed the site, which specific pages are most visited etc.</p>
<p>No detailed Google Analytics data for this site will be shared with any third parties.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="SenseOps mailing list" aria-label="SenseOps mailing list">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.subscribepage.com/g3c1f1">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Discussion forums on GitHub" aria-label="Discussion forums on GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/ptarmiganlabs/butler-auth/discussions">
      <i class="fa fa-comments"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Ptarmigan Labs on Twitter" aria-label="Ptarmigan Labs on Twitter">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ptarmiganlabs">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/gorsan/">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/ptarmiganlabs/butler-auth">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Bug reports &amp; Feature requests" aria-label="Bug reports &amp; Feature requests">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/ptarmiganlabs/butler-auth/issues/new/choose">
      <i class="fa fa-bug"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Get in touch with Ptarmigan Labs" aria-label="Get in touch with Ptarmigan Labs">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="mailto://info@ptarmiganlabs.com">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 Ptarmigan Labs AB All Rights Reserved</small>
        
	
		<p class="mt-2"><a href="/docs/about/">About</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/js/main.min.fbcabf6535c9adab5097a4573d223fb4ef94d03de7f3285822194d5541b1e3b9.js" integrity="sha256-&#43;8q/ZTXJratQl6RXPSI/tO&#43;U0D3n8yhYIhlNVUGx47k=" crossorigin="anonymous"></script>




  </body>
</html>
